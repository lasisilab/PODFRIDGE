<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Junhui He" />

<meta name="date" content="2025-03-01" />

<title>Disparities in Short-Range Familial Searches</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/main/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">PODFRIDGE</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/lasisilab/PODFRIDGE">
    <span class="fab fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Disparities in Short-Range Familial
Searches</h1>
<h4 class="author">Junhui He</h4>
<h4 class="date">2025-03-01</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span>
workflowr <span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2025-03-01
</p>
<p>
<strong>Checks:</strong> <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>PODFRIDGE/</code> <span
class="glyphicon glyphicon-question-sign" aria-hidden="true"
title="This is the local directory in which the code in this file was executed.">
</span>
</p>
<p>
This reproducible <a href="https://rmarkdown.rstudio.com">R Markdown</a>
analysis was created with <a
  href="https://github.com/workflowr/workflowr">workflowr</a> (version
1.7.1). The <em>Checks</em> tab describes the reproducibility checks
that were applied when the results were created. The <em>Past
versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date
</a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git
repository, you know the exact version of the code that produced these
results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the
global environment can affect the analysis in your R Markdown file in
unknown ways. For reproduciblity it’s best to always run the code in an
empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20230302code">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Seed:</strong>
<code>set.seed(20230302)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20230302code"
class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20230302)</code> was run prior to running
the code in the R Markdown file. Setting a seed ensures that any results
that rely on randomness, e.g. subsampling or permutations, are
reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Session information:</strong>
recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package
versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be
confident that you successfully produced the results during this
run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr
project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomlasisilabPODFRIDGEtree887220433768aad4afd56c55d8b52401fca02a47targetblank8872204a">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Repository version:</strong>
<a href="https://github.com/lasisilab/PODFRIDGE/tree/887220433768aad4afd56c55d8b52401fca02a47" target="_blank">8872204</a>
</a>
</p>
</div>
<div
id="strongRepositoryversionstrongahrefhttpsgithubcomlasisilabPODFRIDGEtree887220433768aad4afd56c55d8b52401fca02a47targetblank8872204a"
class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development
and connecting the code version to the results is critical for
reproducibility.
</p>
<p>
The results in this page were generated with repository version
<a href="https://github.com/lasisilab/PODFRIDGE/tree/887220433768aad4afd56c55d8b52401fca02a47" target="_blank">8872204</a>.
See the <em>Past versions</em> tab to see a history of the changes made
to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for
the analysis have been committed to Git prior to generating the results
(you can use <code>wflow_publish</code> or
<code>wflow_git_commit</code>). workflowr only checks the R Markdown
file, but you know if there are other scripts or data files that it
depends on. Below is the status of the Git repository when the results
were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .DS_Store
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not
included in this status report because it is ok for generated content to
have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">
<p>
These are the previous versions of the repository in which changes were
made to the R Markdown (<code>analysis/short-range-disparity.Rmd</code>)
and HTML (<code>docs/short-range-disparity.html</code>) files. If you’ve
configured a remote Git repository (see <code>?wflow_git_remote</code>),
click on the hyperlinks in the table below to view the files as they
were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/887220433768aad4afd56c55d8b52401fca02a47/analysis/short-range-disparity.Rmd" target="_blank">8872204</a>
</td>
<td>
Junhui He
</td>
<td>
2025-03-01
</td>
<td>
modify short-range-disparity report
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lasisilab/PODFRIDGE/e711b4e6b790e0dda95bc86459e20e4d26ed715d/docs/short-range-disparity.html" target="_blank">e711b4e</a>
</td>
<td>
Junhui He
</td>
<td>
2025-02-22
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/a67a6139faf82312d33d24f6da99a4bc52ab27ad/analysis/short-range-disparity.Rmd" target="_blank">a67a613</a>
</td>
<td>
Junhui He
</td>
<td>
2025-02-22
</td>
<td>
update short-range-disparity
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lasisilab/PODFRIDGE/bd3ef154793a489789542a69cc11bf9d836f7d96/docs/short-range-disparity.html" target="_blank">bd3ef15</a>
</td>
<td>
He Junhui
</td>
<td>
2025-02-17
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/a233b4f2808d6ddcc712dd45ad177b01f0db1ce4/analysis/short-range-disparity.Rmd" target="_blank">a233b4f</a>
</td>
<td>
He Junhui
</td>
<td>
2025-02-17
</td>
<td>
create short-range disparity report
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="objective" class="section level2">
<h2>1 Objective</h2>
<p>We aims to examines disparities in the probability of detecting an
individual through short-range familial searches using forensic DNA
databases for Black and White Americans. This analysis integrates
forensic database sizes, forensic database representation (from Result
1), family size distributions (from Result 2), and considers different
levels of true positive rates in determining a familial relationship of
a particular kind.</p>
</div>
<div id="model-assumptions" class="section level2">
<h2>2 Model assumptions</h2>
<ol style="list-style-type: decimal">
<li><p>The population size is <span class="math inline">\(N\)</span>,
and the racial proportion of the population is <span
class="math inline">\(\alpha\)</span>.</p></li>
<li><p>The database has <span class="math inline">\(K\)</span>
individuals, and the racial proportion of the database is <span
class="math inline">\(\beta\)</span>. For a given race, the database is
randomly sampled from the current population. Both the population
proportion <span class="math inline">\(\alpha\)</span> and the database
proportion <span class="math inline">\(\beta\)</span> are considered
fixed constants.</p></li>
<li><p>The family trees of different races are strictly separated. For
instance, the parents and siblings of black Americans are black
Americans, while the parents and siblings of white Americans are white
Americans.</p></li>
<li><p>The number of siblings is assumed to follow a multinomial
distribution. In this model, the distribution is estimated based on the
number of children born to women aged 50-59 in 1990 minus one.</p></li>
<li><p>In the short-range familial search, we only consider the
individual self, the parents and full siblings for detection.</p></li>
<li><p>All related individuals are alive in the population.</p></li>
</ol>
</div>
<div
id="hypothesis-testing-in-determining-a-familial-relationship-with-forensic-str-loci"
class="section level2">
<h2>3 Hypothesis testing in determining a familial relationship with
forensic STR loci</h2>
<p>The short-range familial search utilizes a hypothesis testing to
determine a familial relationship of a particular kind. Specifically,
for a pair of individuals, consider the following null and alternative
hypothesis: <span class="math display">\[H_0:\text{unrelated
pairs}\leftrightarrow H_1:  \text{exist a certain familial
relationship}.\]</span> The kinds of familial relationship involved in
short-range familial search contain the individual, parents and full
siblings.</p>
<p>When the alternative hypothesis is accepted, there is supposed to
exist a certain kind of relationship between the pair of individuals,
and we call it a positive test. There are two possibilities for a
positive test:</p>
<ol style="list-style-type: decimal">
<li>False positive: The two individuals are unrelated in fact, but the
test claims they are related mistakenly.</li>
<li>True positive: The two individuals are related and the test detects
their relationship correctly.</li>
</ol>
<p>In this analysis, we denote the True Positive Rate as TPR, and denote
the False Positive Rate as FPR. The short-range familial search conducts
a likelihood ratio test (LRT) to detect the relationship. The
performance of LRT will depend on many factors, including the familial
relationshiop considered in the test, the number of STR loci, population
allele frequency differences and cutoff thresholds. See Result 4 for
further discussions.</p>
</div>
<div id="the-detection-probability" class="section level2">
<h2>4 The detection probability</h2>
<div id="definition" class="section level3">
<h3>4.1 Definition</h3>
<p>Before our formal derivation, we have to define the concept of a
detection. A detection, or a match is the decision that we accept the
alternative hypothesis in the likelihood ratio test. Consequently, a
detection is equivalent to a positive test. A detection contains two
possible cases: (1) correct detection, corresponding to true positive;
(2) incorrect detection, corresponding to false positive.</p>
</div>
<div id="derivation" class="section level3">
<h3>4.2 Derivation</h3>
<p>We give a step-by-step derivation for the detection probability in a
database.</p>
<ol style="list-style-type: decimal">
<li><p>For any random person, the probability of the event {A person is
present in a database} is <span
class="math inline">\(P(present)=\frac{\beta K}{\alpha N}\)</span>,
where <span class="math inline">\(K\)</span> is the database size, <span
class="math inline">\(N\)</span> is the population size, <span
class="math inline">\(\beta\)</span> and <span
class="math inline">\(\alpha\)</span> and racial proportions in the
database and population.</p></li>
<li><p>Suppose the individual has <span class="math inline">\(n\)</span>
relatives. The probability of the event {<span
class="math inline">\(k\)</span> relatives present in the database,
<span class="math inline">\(n-k\)</span> relatives absent in the
database | <span class="math inline">\(n\)</span> relatives} is <span
class="math inline">\(Bin(k;n,P(present))={n \choose k}
P(present)^k(1-P(present))^{n-k}\)</span>.</p></li>
<li><p>Suppose <span class="math inline">\(k\)</span> relatives are
present in the database and <span class="math inline">\(n-k\)</span>
relatives are absent in the database. The number of detection inside and
outside the database follows <span class="math inline">\(Bin(k,
TPR)\)</span> and <span class="math inline">\(Bin(n-k, FPR)\)</span>,
respectively. Thus, the probability of the event {at least one detection
| <span class="math inline">\(k\)</span> relatives present in the
database, <span class="math inline">\(n-k\)</span> relatives absent in
the database} is <span class="math inline">\(1 -
(1-TPR)^k(1-FPR)^{n-k}\)</span>.</p></li>
<li><p>For a given short-range familial relationship, the probability of
the event {at least one detection of a certain relationship} is <span
class="math display">\[P(at~least~one~detection~of~a~certain~relationship)=\\\sum_{n=1}^{n_\max}P(n~relatives)\sum_{k=0}^nBin(k;n,P(present))\{1
- (1-TPR)^k(1-FPR)^{n-k}\}.\]</span></p></li>
<li><p>The probability of the event {at least one detection} is the sum
of the probability in Step 4 across relationships of the individual,
parents and full sibling.</p></li>
</ol>
</div>
</div>
<div id="experiments" class="section level2">
<h2>5 Experiments</h2>
<p>We focus on short-range familial search in the United States, and
will calculate the detection probabilities for Black and White Americans
state-by-state.</p>
<div id="settings" class="section level3">
<h3>5.1 Settings</h3>
<p>Our analysis examines how family size distributions, database
representation and true/false positive rate influence the probability of
detecting an individual in a database.</p>
<ol style="list-style-type: decimal">
<li>The number of siblings whose mothers are women aged 50-59 in 1990 is
given in the following figure:</li>
</ol>
<p><img src="figure/short-range-disparity.Rmd/sibling-number-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-sibling-number-1">
Past versions of sibling-number-1.png
</button>
</p>
<div id="fig-sibling-number-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/e711b4e6b790e0dda95bc86459e20e4d26ed715d/docs/figure/short-range-disparity.Rmd/sibling-number-1.png" target="_blank">e711b4e</a>
</td>
<td>
Junhui He
</td>
<td>
2025-02-22
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Following Result 2, we use a negative binomial distribution to model
the number of siblings for White Americans, and use a zero-inflated
negative binomial distribution to model the number of siblings for Black
Americans. In calculating the detection probability, we truncate the
number of siblings at <span class="math inline">\(20\)</span>. In
addition, we assume that all states follow the same distribution of
number of sibling.</p>
<ol start="2" style="list-style-type: decimal">
<li>We use Census data as the population, and use CODIS data as the
forensic database. The state-level population and forensic database size
by race is given as follows:</li>
</ol>
<table style="width:100%;">
<colgroup>
<col width="16%" />
<col width="14%" />
<col width="14%" />
<col width="14%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">State</th>
<th align="right">census.total</th>
<th align="right">census.black</th>
<th align="right">census.white</th>
<th align="right">codis.total</th>
<th align="right">codis.black</th>
<th align="right">codis.white</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alabama</td>
<td align="right">4767326</td>
<td align="right">1296162</td>
<td align="right">3220452</td>
<td align="right">39545</td>
<td align="right">18253</td>
<td align="right">21292</td>
</tr>
<tr class="even">
<td align="left">Alaska</td>
<td align="right">643867</td>
<td align="right">21898</td>
<td align="right">435392</td>
<td align="right">35311</td>
<td align="right">914</td>
<td align="right">5237</td>
</tr>
<tr class="odd">
<td align="left">Arizona</td>
<td align="right">6154696</td>
<td align="right">339150</td>
<td align="right">4322337</td>
<td align="right">73669</td>
<td align="right">9313</td>
<td align="right">34353</td>
</tr>
<tr class="even">
<td align="left">Arkansas</td>
<td align="right">2797949</td>
<td align="right">453783</td>
<td align="right">2114512</td>
<td align="right">10395</td>
<td align="right">4401</td>
<td align="right">5715</td>
</tr>
<tr class="odd">
<td align="left">California</td>
<td align="right">33777988</td>
<td align="right">2237044</td>
<td align="right">16296122</td>
<td align="right">567170</td>
<td align="right">141488</td>
<td align="right">210144</td>
</tr>
<tr class="even">
<td align="left">Colorado</td>
<td align="right">5066044</td>
<td align="right">234828</td>
<td align="right">4082927</td>
<td align="right">223434</td>
<td align="right">28486</td>
<td align="right">140920</td>
</tr>
<tr class="odd">
<td align="left">Connecticut</td>
<td align="right">3273040</td>
<td align="right">388675</td>
<td align="right">2395128</td>
<td align="right">8809</td>
<td align="right">2250</td>
<td align="right">4968</td>
</tr>
<tr class="even">
<td align="left">Delaware</td>
<td align="right">913430</td>
<td align="right">218899</td>
<td align="right">597763</td>
<td align="right">11760</td>
<td align="right">9399</td>
<td align="right">1701</td>
</tr>
<tr class="odd">
<td align="left">Florida</td>
<td align="right">17986115</td>
<td align="right">3246381</td>
<td align="right">12422961</td>
<td align="right">544332</td>
<td align="right">20152</td>
<td align="right">514348</td>
</tr>
<tr class="even">
<td align="left">Georgia</td>
<td align="right">9968000</td>
<td align="right">3320513</td>
<td align="right">5555483</td>
<td align="right">15047</td>
<td align="right">9851</td>
<td align="right">4682</td>
</tr>
<tr class="odd">
<td align="left">Hawaii</td>
<td align="right">1087142</td>
<td align="right">23417</td>
<td align="right">333261</td>
<td align="right">11131</td>
<td align="right">516</td>
<td align="right">3018</td>
</tr>
<tr class="even">
<td align="left">Idaho</td>
<td align="right">1685901</td>
<td align="right">15726</td>
<td align="right">1510360</td>
<td align="right">8041</td>
<td align="right">244</td>
<td align="right">6253</td>
</tr>
<tr class="odd">
<td align="left">Illinois</td>
<td align="right">11667524</td>
<td align="right">1808271</td>
<td align="right">7868227</td>
<td align="right">31094</td>
<td align="right">18094</td>
<td align="right">9094</td>
</tr>
<tr class="even">
<td align="left">Indiana</td>
<td align="right">6348802</td>
<td align="right">648513</td>
<td align="right">5241795</td>
<td align="right">14468</td>
<td align="right">3591</td>
<td align="right">10479</td>
</tr>
<tr class="odd">
<td align="left">Iowa</td>
<td align="right">3011086</td>
<td align="right">131972</td>
<td align="right">2694521</td>
<td align="right">23017</td>
<td align="right">4793</td>
<td align="right">17021</td>
</tr>
<tr class="even">
<td align="left">Kansas</td>
<td align="right">2657373</td>
<td align="right">168809</td>
<td align="right">2222462</td>
<td align="right">48538</td>
<td align="right">13016</td>
<td align="right">35318</td>
</tr>
<tr class="odd">
<td align="left">Kentucky</td>
<td align="right">4260996</td>
<td align="right">362417</td>
<td align="right">3711254</td>
<td align="right">118670</td>
<td align="right">34762</td>
<td align="right">76716</td>
</tr>
<tr class="even">
<td align="left">Louisiana</td>
<td align="right">4384380</td>
<td align="right">1464023</td>
<td align="right">2657652</td>
<td align="right">16469</td>
<td align="right">10840</td>
<td align="right">4972</td>
</tr>
<tr class="odd">
<td align="left">Maine</td>
<td align="right">1297649</td>
<td align="right">25752</td>
<td align="right">1237041</td>
<td align="right">3202</td>
<td align="right">226</td>
<td align="right">2846</td>
</tr>
<tr class="even">
<td align="left">Maryland</td>
<td align="right">5695323</td>
<td align="right">1820472</td>
<td align="right">3007874</td>
<td align="right">55491</td>
<td align="right">34835</td>
<td align="right">20207</td>
</tr>
<tr class="odd">
<td align="left">Massachusetts</td>
<td align="right">6421050</td>
<td align="right">494029</td>
<td align="right">4896037</td>
<td align="right">14681</td>
<td align="right">2712</td>
<td align="right">9681</td>
</tr>
<tr class="even">
<td align="left">Michigan</td>
<td align="right">9442016</td>
<td align="right">1376579</td>
<td align="right">7444974</td>
<td align="right">256960</td>
<td align="right">85888</td>
<td align="right">168422</td>
</tr>
<tr class="odd">
<td align="left">Minnesota</td>
<td align="right">5360773</td>
<td align="right">398434</td>
<td align="right">4423146</td>
<td align="right">155525</td>
<td align="right">39743</td>
<td align="right">103741</td>
</tr>
<tr class="even">
<td align="left">Mississippi</td>
<td align="right">2850547</td>
<td align="right">1084481</td>
<td align="right">1658893</td>
<td align="right">10612</td>
<td align="right">6328</td>
<td align="right">4193</td>
</tr>
<tr class="odd">
<td align="left">Missouri</td>
<td align="right">5741742</td>
<td align="right">699840</td>
<td align="right">4740335</td>
<td align="right">11783</td>
<td align="right">3701</td>
<td align="right">7882</td>
</tr>
<tr class="even">
<td align="left">Montana</td>
<td align="right">1012950</td>
<td align="right">5484</td>
<td align="right">916524</td>
<td align="right">2460</td>
<td align="right">47</td>
<td align="right">1961</td>
</tr>
<tr class="odd">
<td align="left">Nebraska</td>
<td align="right">1817341</td>
<td align="right">96535</td>
<td align="right">1538052</td>
<td align="right">2451</td>
<td align="right">566</td>
<td align="right">1483</td>
</tr>
<tr class="even">
<td align="left">Nevada</td>
<td align="right">2670605</td>
<td align="right">304739</td>
<td align="right">1588463</td>
<td align="right">5629</td>
<td align="right">1602</td>
<td align="right">2590</td>
</tr>
<tr class="odd">
<td align="left">New Hampshire</td>
<td align="right">1299787</td>
<td align="right">20127</td>
<td align="right">1216203</td>
<td align="right">624</td>
<td align="right">40</td>
<td align="right">578</td>
</tr>
<tr class="even">
<td align="left">New Jersey</td>
<td align="right">8385500</td>
<td align="right">1219770</td>
<td align="right">5112280</td>
<td align="right">17898</td>
<td align="right">9444</td>
<td align="right">6708</td>
</tr>
<tr class="odd">
<td align="left">New Mexico</td>
<td align="right">1695276</td>
<td align="right">45904</td>
<td align="right">1078937</td>
<td align="right">2621</td>
<td align="right">157</td>
<td align="right">813</td>
</tr>
<tr class="even">
<td align="left">New York</td>
<td align="right">18433786</td>
<td align="right">2986172</td>
<td align="right">11143349</td>
<td align="right">132709</td>
<td align="right">68684</td>
<td align="right">17116</td>
</tr>
<tr class="odd">
<td align="left">North Carolina</td>
<td align="right">9727667</td>
<td align="right">2140217</td>
<td align="right">6488459</td>
<td align="right">23450</td>
<td align="right">12270</td>
<td align="right">11138</td>
</tr>
<tr class="even">
<td align="left">North Dakota</td>
<td align="right">737154</td>
<td align="right">26783</td>
<td align="right">645938</td>
<td align="right">32509</td>
<td align="right">2983</td>
<td align="right">24363</td>
</tr>
<tr class="odd">
<td align="left">Ohio</td>
<td align="right">11118076</td>
<td align="right">1478781</td>
<td align="right">9080688</td>
<td align="right">71913</td>
<td align="right">26015</td>
<td align="right">45454</td>
</tr>
<tr class="even">
<td align="left">Oklahoma</td>
<td align="right">3451195</td>
<td align="right">289961</td>
<td align="right">2514885</td>
<td align="right">10656</td>
<td align="right">2841</td>
<td align="right">5853</td>
</tr>
<tr class="odd">
<td align="left">Oregon</td>
<td align="right">3793917</td>
<td align="right">82655</td>
<td align="right">3169096</td>
<td align="right">5045</td>
<td align="right">515</td>
<td align="right">3552</td>
</tr>
<tr class="even">
<td align="left">Pennsylvania</td>
<td align="right">12228216</td>
<td align="right">1423169</td>
<td align="right">9750687</td>
<td align="right">10238</td>
<td align="right">4159</td>
<td align="right">5088</td>
</tr>
<tr class="odd">
<td align="left">Rhode Island</td>
<td align="right">995585</td>
<td align="right">62168</td>
<td align="right">782920</td>
<td align="right">14465</td>
<td align="right">3672</td>
<td align="right">7852</td>
</tr>
<tr class="even">
<td align="left">South Carolina</td>
<td align="right">4820049</td>
<td align="right">1280531</td>
<td align="right">3243442</td>
<td align="right">6955</td>
<td align="right">3752</td>
<td align="right">3203</td>
</tr>
<tr class="odd">
<td align="left">South Dakota</td>
<td align="right">840002</td>
<td align="right">17842</td>
<td align="right">715336</td>
<td align="right">40687</td>
<td align="right">2961</td>
<td align="right">25411</td>
</tr>
<tr class="even">
<td align="left">Tennessee</td>
<td align="right">6497942</td>
<td align="right">1092948</td>
<td align="right">4990938</td>
<td align="right">40544</td>
<td align="right">14544</td>
<td align="right">25620</td>
</tr>
<tr class="odd">
<td align="left">Texas</td>
<td align="right">24011767</td>
<td align="right">3552997</td>
<td align="right">14609365</td>
<td align="right">70955</td>
<td align="right">22169</td>
<td align="right">25519</td>
</tr>
<tr class="even">
<td align="left">Utah</td>
<td align="right">2992603</td>
<td align="right">40058</td>
<td align="right">2573413</td>
<td align="right">110189</td>
<td align="right">5993</td>
<td align="right">94992</td>
</tr>
<tr class="odd">
<td align="left">Vermont</td>
<td align="right">606051</td>
<td align="right">9034</td>
<td align="right">577751</td>
<td align="right">2754</td>
<td align="right">295</td>
<td align="right">2423</td>
</tr>
<tr class="even">
<td align="left">Virginia</td>
<td align="right">7925686</td>
<td align="right">1607581</td>
<td align="right">5208856</td>
<td align="right">12379</td>
<td align="right">6249</td>
<td align="right">5836</td>
</tr>
<tr class="odd">
<td align="left">Washington</td>
<td align="right">6868622</td>
<td align="right">307565</td>
<td align="right">5130920</td>
<td align="right">7413</td>
<td align="right">1376</td>
<td align="right">4585</td>
</tr>
<tr class="even">
<td align="left">West Virginia</td>
<td align="right">1708772</td>
<td align="right">65813</td>
<td align="right">1610749</td>
<td align="right">3412</td>
<td align="right">955</td>
<td align="right">2218</td>
</tr>
<tr class="odd">
<td align="left">Wisconsin</td>
<td align="right">5534184</td>
<td align="right">376256</td>
<td align="right">4737545</td>
<td align="right">9324</td>
<td align="right">3482</td>
<td align="right">5253</td>
</tr>
<tr class="even">
<td align="left">Wyoming</td>
<td align="right">533378</td>
<td align="right">5232</td>
<td align="right">488374</td>
<td align="right">3353</td>
<td align="right">129</td>
<td align="right">2482</td>
</tr>
</tbody>
</table>
<p>Furthermore, we show the proportions of database size/population size
for Black and White Americans in the following figure.</p>
<p><img src="figure/short-range-disparity.Rmd/plot-proportion-1.png" width="672" style="display: block; margin: auto;" /><img src="figure/short-range-disparity.Rmd/plot-proportion-2.png" width="672" style="display: block; margin: auto;" /></p>
<ol start="3" style="list-style-type: decimal">
<li>True/False positive rate: The relationship between true and false
positive rate is super complex in short-range familial search. It could
depend on the hypothesis type, the likelihood cutoff, the number of STR
loci, the race and so on. See <a
href="https://lasisilab.github.io/PODFRIDGE/lr_dist.html">Likelihood
Ratio Distribution</a> for an overview.</li>
</ol>
<p>In this analysis, we consider a special case of true/false positive
rates. For individual hypothesis, TPR is set to 1 and FPR is set to 0.
For parent-child hypothesis, TPR is set to 1 and FPR is set to 0.01%.
For full-sibling hypothesis, TPR is set to 75% and FPR is set to 1%.</p>
</div>
<div id="state-level-detection-probabilities" class="section level3">
<h3>5.2 State-level detection probabilities</h3>
<p><img src="figure/short-range-disparity.Rmd/plot-1.png" width="672" style="display: block; margin: auto;" /><img src="figure/short-range-disparity.Rmd/plot-2.png" width="672" style="display: block; margin: auto;" /><img src="figure/short-range-disparity.Rmd/plot-3.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="conclusions" class="section level3">
<h3>5.3 Conclusions</h3>
<ol style="list-style-type: decimal">
<li><p>The detection probability for Black Americans is higher than that
for White Americans in all states except for Florida. This is because
(1) Black Americans have mildly more siblings than White Americans, and
(2) Black Americans are overrepresented while White Americans are
underrepresented in the forensic database.</p></li>
<li><p>The situation is opposite in Florida, where Black Americans are
underrepresented while White Americans are overrepresented in the
forensic database.</p></li>
</ol>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>
Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre><code>R version 4.4.2 (2024-10-31)
Platform: aarch64-apple-darwin20
Running under: macOS Sequoia 15.3.1

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/Detroit
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] ggpubr_0.6.0    ggplot2_3.5.1   workflowr_1.7.1

loaded via a namespace (and not attached):
 [1] tidyr_1.3.1       sass_0.4.9        utf8_1.2.4        generics_0.1.3   
 [5] rstatix_0.7.2     stringi_1.8.4     digest_0.6.37     magrittr_2.0.3   
 [9] evaluate_1.0.1    grid_4.4.2        fastmap_1.2.0     rprojroot_2.0.4  
[13] jsonlite_1.8.9    processx_3.8.4    whisker_0.4.1     backports_1.5.0  
[17] Formula_1.2-5     ps_1.8.1          promises_1.3.2    httr_1.4.7       
[21] purrr_1.0.2       fansi_1.0.6       scales_1.3.0      jquerylib_0.1.4  
[25] abind_1.4-8       cli_3.6.3         rlang_1.1.4       munsell_0.5.1    
[29] withr_3.0.2       cachem_1.1.0      yaml_2.3.10       tools_4.4.2      
[33] ggsignif_0.6.4    dplyr_1.1.4       colorspace_2.1-1  httpuv_1.6.15    
[37] broom_1.0.7       vctrs_0.6.5       R6_2.5.1          lifecycle_1.0.4  
[41] git2r_0.35.0      stringr_1.5.1     car_3.1-3         fs_1.6.5         
[45] pkgconfig_2.0.3   callr_3.7.6       pillar_1.9.0      bslib_0.8.0      
[49] later_1.4.1       gtable_0.3.6      glue_1.8.0        Rcpp_1.0.13-1    
[53] xfun_0.49         tibble_3.2.1      tidyselect_1.2.1  rstudioapi_0.17.1
[57] knitr_1.49        farver_2.1.2      htmltools_0.5.8.1 labeling_0.4.3   
[61] carData_3.0-5     rmarkdown_2.29    compiler_4.4.2    getPass_0.2-4    </code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
https://docs.mathjax.org/en/latest/web/configuration.html. This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>

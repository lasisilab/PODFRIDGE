<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />



<meta name="date" content="2024-04-28" />

<title>Regression to predict CODIS database proportions</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.4.0/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.0/css/v4-shims.min.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/main/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">PODFRIDGE</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="methods.html">Methods</a>
</li>
<li>
  <a href="demo-data.html">Demographic Data</a>
</li>
<li>
  <a href="database-composition.html">Database composition</a>
</li>
<li>
  <a href="STR-simulation.html">STR simulations</a>
</li>
<li>
  <a href="CODIS-STR-freqs.html">CODIS STRs</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/tinalasisi/PODFRIDGE">
    <span class="fab fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Regression to predict CODIS database proportions</h1>
<h4 class="date">2024-04-28</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2024-08-14
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>PODFRIDGE/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="https://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/workflowr/workflowr">workflowr</a> (version 1.7.1). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20230302code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20230302)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20230302code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20230302)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomlasisilabPODFRIDGEtreebe5e7b513f85054b446ee8d634f99496d978dcd6targetblankbe5e7b5a"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/lasisilab/PODFRIDGE/tree/be5e7b513f85054b446ee8d634f99496d978dcd6" target="_blank">be5e7b5</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomlasisilabPODFRIDGEtreebe5e7b513f85054b446ee8d634f99496d978dcd6targetblankbe5e7b5a" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility.
</p>
<p>
The results in this page were generated with repository version <a href="https://github.com/lasisilab/PODFRIDGE/tree/be5e7b513f85054b446ee8d634f99496d978dcd6" target="_blank">be5e7b5</a>. See the <em>Past versions</em> tab to see a history of the changes made to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Untracked files:
    Untracked:  PODFRIDGE/
    Untracked:  Rplots.pdf
    Untracked:  data/final_CODIS_data.csv

Unstaged changes:
    Modified:   analysis/final_equation.Rmd
    Modified:   output/aggregated_llr_results_by_population.csv

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were made to the R Markdown (<code>analysis/regression.Rmd</code>) and HTML (<code>docs/regression.html</code>) files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lasisilab/PODFRIDGE/be5e7b513f85054b446ee8d634f99496d978dcd6/docs/regression.html" target="_blank">be5e7b5</a>
</td>
<td>
hcvw
</td>
<td>
2024-08-14
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/b9997a4017344c87b7d57138cd7e0647c56f7f1c/analysis/regression.Rmd" target="_blank">b9997a4</a>
</td>
<td>
hcvw
</td>
<td>
2024-08-14
</td>
<td>
wflow_publish(c(“analysis/regression.Rmd”, “data/SDIS.csv”, “data/NDIS.csv”,
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lasisilab/PODFRIDGE/e6972d6cd3bf0ed3cf847aafecdf8412fcf0f114/docs/regression.html" target="_blank">e6972d6</a>
</td>
<td>
hcvw
</td>
<td>
2024-06-25
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lasisilab/PODFRIDGE/1eb6d2cb2c207e16d81400f8012b40c6815a9e07/docs/regression.html" target="_blank">1eb6d2c</a>
</td>
<td>
hcvw
</td>
<td>
2024-06-25
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/96b197a88e873ab1b62d1c3b279fdff3b81e0c42/analysis/regression.Rmd" target="_blank">96b197a</a>
</td>
<td>
hcvw
</td>
<td>
2024-06-25
</td>
<td>
wflow_publish(c(“analysis/regression.Rmd”))
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<pre class="r"><code># Load necessary libraries
library(readr)        # read csv files
library(tidyverse)    # census API
library(knitr)        
library(jtools) 
library(sandwich)     # robust covariance estimator
library(ggplot2)      # For plotting
library(stats)        # For statistical functions
library(tidycensus)   # For accessing US census data
# Load additional libraries for combining plots
library(cowplot)
library(ggpubr) 
library(viridis)
library(sf)

# Load prison data
prison_data = read.csv(&quot;./data/populations_states.csv&quot;)

# Load CODIS data
codis_data = read.csv(&quot;./data/CODIS_data.csv&quot;)

# Create a data frame for Murphy and Tong profiles
murphy.tong = data.frame(
  state = c(&quot;California&quot;, &quot;Florida&quot;, &quot;Indiana&quot;, &quot;Maine&quot;, &quot;Nevada&quot;, &quot;South Dakota&quot;, &quot;Texas&quot;), 
  total = c(2768269, 1350667, 307714, 32847, 167726, 67600, 960985,2768269, 1350667, 307714, 32847, 167726, 67600, 960985),
  mt.percent = c(0.296, 0.614, 0.7, 0.928, 0.694, 0.668, 0.373,0.171, 0.352, 0.26, 0.039, 0.256, 0.06, 0.291),
  race = c(&quot;White&quot;,&quot;White&quot;,&quot;White&quot;,&quot;White&quot;,&quot;White&quot;,&quot;White&quot;,&quot;White&quot;,&quot;Black&quot;,&quot;Black&quot;,&quot;Black&quot;,&quot;Black&quot;,&quot;Black&quot;,&quot;Black&quot;,&quot;Black&quot;)
)</code></pre>
<pre class="r"><code># Load necessary libraries

# Calculate the number of White and Black profiles in Murphy and Tong data
murphy.tong$n = murphy.tong$total * murphy.tong$mt.percent

# Extract year from the date and filter data for 2022
prison_data$year = substring(prison_data$date, 1, 4)
prison_data_2022 = prison_data[which(prison_data$year == &quot;2022&quot;),]
prison_data_2022 = prison_data_2022[!duplicated(prison_data_2022[, &#39;state&#39;]),]

# Load census data for each state
# P1_002N is the total population, P1_003N is the total White population, and P1_004N is the total Black population
us_state_density &lt;- get_decennial(
  geography = &quot;state&quot;,
  variables = c(all = &quot;P1_002N&quot;, white = &quot;P1_003N&quot;, black = &quot;P1_004N&quot;),
  year = 2020,
  geometry = TRUE,
  keep_geo_vars = TRUE
)

# Spread the data into a wider format
us_state_density = spread(us_state_density, variable, value)

# Calculate the proportion of Black and White populations
us_state_density$census.percent.black = us_state_density$black / us_state_density$all
us_state_density$census.percent.white = us_state_density$white / us_state_density$all

# Rename column for merging
us_state_density$state = us_state_density$NAME.x

# Merge census data with prison data
us_state_density = merge(us_state_density, prison_data_2022, by = &quot;state&quot;)

# Calculate the proportion of Black and White incarcerated individuals
us_state_density$percent.black.incarc = us_state_density$incarcerated_black / us_state_density$incarcerated_total
us_state_density$percent.white.incarc = us_state_density$incarcerated_white / us_state_density$incarcerated_total

# Merge with CODIS data
us_state_density = merge(us_state_density, codis_data, by = &quot;state&quot;)

# Calculate the number of Black and White profiles in CODIS
us_state_density$black_profiles = us_state_density$percent.black.incarc * (us_state_density$offender_profiles)
us_state_density$white_profiles = us_state_density$percent.white.incarc * (us_state_density$offender_profiles)

us_state_density_black = as.data.frame(us_state_density[,c(&quot;state&quot;,&quot;all&quot;,&quot;black&quot;,&quot;census.percent.black&quot;,&quot;incarcerated_total&quot;,
                                       &quot;incarcerated_black&quot;,&quot;percent.black.incarc&quot;,&quot;arrestee_profiles&quot;,&quot;offender_profiles&quot;,&quot;black_profiles&quot;)])
us_state_density_black$race = &quot;Black&quot;
colnames(us_state_density_black) = c(&quot;state&quot;,&quot;all&quot;,&quot;population&quot;,&quot;census.percent&quot;,&quot;incarcerated_total&quot;,
                                     &quot;incarcerated_race&quot;,&quot;percent.incar&quot;,&quot;arrestee_profiles&quot;,&quot;offender_profiles&quot;,&quot;geometry&quot;,&quot;race_profiles&quot;,&quot;race&quot;)

us_state_density_white = as.data.frame(us_state_density[,c(&quot;state&quot;,&quot;all&quot;,&quot;white&quot;,&quot;census.percent.white&quot;,&quot;incarcerated_total&quot;,
                                             &quot;incarcerated_white&quot;,&quot;percent.white.incarc&quot;, &quot;arrestee_profiles&quot;,&quot;offender_profiles&quot;,&quot;white_profiles&quot;)])
us_state_density_white$race = &quot;White&quot;
colnames(us_state_density_white) = c(&quot;state&quot;,&quot;all&quot;,&quot;population&quot;,&quot;census.percent&quot;,&quot;incarcerated_total&quot;,
                                     &quot;incarcerated_race&quot;,&quot;percent.incar&quot;,&quot;arrestee_profiles&quot;,&quot;offender_profiles&quot;,&quot;geometry&quot;,&quot;race_profiles&quot;,&quot;race&quot;)

inferred_data = rbind(us_state_density_black, us_state_density_white)

# Combine Murphy and Tong data with the merged dataset
combined = merge(murphy.tong, inferred_data, by = c(&quot;state&quot;,&quot;race&quot;), all.x = TRUE)
combined$race_bin = ifelse(combined$race == &quot;White&quot;,0,1)</code></pre>
<pre class="r"><code># Fit linear models for Black and White population proportions
model.all &lt;- lm(
    mt.percent ~           # Outcome: Murphy &amp; Tong numbers for 7 states
    census.percent +       # Main effect of census proportion on CODIS proportion
    percent.incar +        # Main effect of prison proportion on CODIS proportion
    race_bin+                 # Main effect of race. This will estimate the change in CODIS proportion for different races relative to a baseline race.
    race_bin:census.percent +  # Interaction between race and census proportion.
                           # This checks if the effect of census proportion on CODIS proportion varies by race.
    race_bin:percent.incar,    # Interaction between race and prison proportion.
                           # This checks if the effect of prison proportion on CODIS proportion varies by race.
    data = combined        # The data set containing the variables
)

summary(model.all)
plot_summs(model.all, robust = TRUE)</code></pre>
<p><img src="figure/regression.Rmd/proportion_regression-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-proportion_regression-1">
Past versions of proportion_regression-1.png
</button>
</p>
<div id="fig-proportion_regression-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/be5e7b513f85054b446ee8d634f99496d978dcd6/docs/figure/regression.Rmd/proportion_regression-1.png" target="_blank">be5e7b5</a>
</td>
<td>
hcvw
</td>
<td>
2024-08-14
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># Run regression model for different combinations of the following predictors:
# race, census proportion of race, estimated population from Klein data
formula_a = &quot;census.percent + percent.incar + race_bin&quot; # no interactions
formula_b = &quot;percent.incar + race_bin + race_bin:percent.incar&quot; # no census
formula_c = &quot;percent.incar + race_bin&quot;  # no census or interaction
formula_d = &quot;census.percent + percent.incar&quot; # no race

formulas = c(formula_a, formula_b, formula_c, formula_d)

model_df = as.data.frame(matrix(0,nrow = 4, ncol = 3))
colnames(model_df) = c(&quot;model&quot;,&quot;R^2&quot;,&quot;Anova&quot;)
for(i in 1:4){
  form = formulas[[i]]
  model &lt;- lm(paste0(&#39;mt.percent ~&#39;, form), data = combined)
  p.val = round(anova(model, model.all)[[6]][2],2)
  model_df[i,] = c(form, round(summary(model)$adj.r.squared,2),p.val)
}
kable(model_df)

# generate predictions based on the model with all coefficients
combined$prediction = predict(model.all, combined)</code></pre>
<pre class="r"><code># Plot the results with linear regression lines
ggplot(data = combined) +
  geom_point(aes(x = prediction, y = mt.percent,fill=state,shape = race),size=5,col=&quot;black&quot;) +
  scale_shape_manual(name=&quot;Race&quot;,labels = c(&quot;Black&quot;,&quot;White&quot;),values = c(21,24)) +
  geom_abline(intercept = 0, slope = 1,col =&quot;grey30&quot;, linetype = &quot;dashed&quot;,size=1.5) +
  theme_classic() + xlab(&quot;Estimated CODIS profiles&quot;) + ylab(&quot;Murphy &amp; Tong profiles (FOIA)&quot;) +
  annotate(&quot;text&quot;, x=0.2, y=0.75, size = 6, label= paste0(as.expression(&quot;R² = &quot;), round(summary(model)$adj.r.squared,2))) +
  annotate(&quot;text&quot;, x=0.6, y=0.56, size = 4, label= &quot;Perfect prediction line&quot;,angle = 46) +
  guides(fill=guide_legend(override.aes=list(shape=21))) +
  theme(axis.text.x = element_text(color = &quot;black&quot;, size = 16, angle = 0, hjust = .5, vjust = .5, face = &quot;plain&quot;),
        axis.text.y = element_text(color = &quot;black&quot;, size = 16, angle = 0, hjust = 1, vjust = 0, face = &quot;plain&quot;),  
        axis.title.x = element_text(color = &quot;black&quot;, size = 16, angle = 0, hjust = .5, vjust = 0, face = &quot;plain&quot;),
        axis.title.y = element_text(color = &quot;black&quot;, size = 16, angle = 90, hjust = .5, vjust = .5, face = &quot;plain&quot;),
        aspect.ratio=1) </code></pre>
<p><img src="figure/regression.Rmd/plots-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-plots-1">
Past versions of plots-1.png
</button>
</p>
<div id="fig-plots-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/1eb6d2cb2c207e16d81400f8012b40c6815a9e07/docs/figure/regression.Rmd/plots-1.png" target="_blank">1eb6d2c</a>
</td>
<td>
hcvw
</td>
<td>
2024-06-25
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>combined$Dif &lt;- combined$prediction - combined$mt.percent
combined$Avg &lt;- (combined$prediction + combined$mt.percent) / 2

ggplot(combined, aes(x = Avg, y = Dif)) +
  geom_point(aes(shape = race,fill=state),size=4,col=&quot;black&quot;) +
  scale_fill_discrete(name = &quot;State&quot;) +
  guides(fill=guide_legend(override.aes=list(shape=21))) +
  scale_shape_manual(name=&quot;Race&quot;,labels = c(&quot;Black&quot;,&quot;White&quot;),values = c(21,24)) +
  geom_hline(yintercept = mean(combined$Dif), colour = &quot;black&quot;, size = 1) +
  geom_hline(yintercept = mean(combined$Dif) - (1.96 * sd(combined$Dif)), colour = &quot;grey30&quot;, size = 0.5) +
  geom_hline(yintercept = mean(combined$Dif) + (1.96 * sd(combined$Dif)), colour = &quot;grey30&quot;, size = 0.5) +
  ylab(&quot;Difference Between Measures&quot;) +
  xlab(&quot;Average Measure&quot;) + theme_light() +
  theme(axis.text.x = element_text(color = &quot;black&quot;, size = 16, angle = 0, hjust = .5, vjust = .5, face = &quot;plain&quot;),
        axis.text.y = element_text(color = &quot;black&quot;, size = 16, angle = 0, hjust = 1, vjust = 0, face = &quot;plain&quot;),  
        axis.title.x = element_text(color = &quot;black&quot;, size = 16, angle = 0, hjust = .5, vjust = 0, face = &quot;plain&quot;),
        axis.title.y = element_text(color = &quot;black&quot;, size = 16, angle = 90, hjust = .5, vjust = .5, face = &quot;plain&quot;),
        aspect.ratio=1) </code></pre>
<p><img src="figure/regression.Rmd/plots-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-plots-2">
Past versions of plots-2.png
</button>
</p>
<div id="fig-plots-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/1eb6d2cb2c207e16d81400f8012b40c6815a9e07/docs/figure/regression.Rmd/plots-2.png" target="_blank">1eb6d2c</a>
</td>
<td>
hcvw
</td>
<td>
2024-06-25
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># Read in CSV files
NDIS = read.csv(&quot;./data/NDIS.csv&quot;)       # National DNA Index System data
SDIS = read.csv(&quot;./data/SDIS.csv&quot;)       # State DNA Index System data

# Merge NDIS and SDIS datasets by state
NDIS_SDIS = merge(NDIS, SDIS, by = &quot;State&quot;)

# Rename columns to distinguish between NDIS and SDIS data
colnames(NDIS_SDIS) &lt;- gsub(&#39;.x&#39;,&#39;.NDIS&#39;, names(NDIS_SDIS))
colnames(NDIS_SDIS) &lt;- gsub(&#39;.y&#39;,&#39;.SDIS&#39;, names(NDIS_SDIS))

# Merge NDIS_SDIS data with prison data
colnames(prison_data_2022)[12] = &quot;State&quot;
SDIS_states = merge(NDIS_SDIS, prison_data_2022, by = &quot;State&quot;)

# Merge census data with NDIS_SDIS_prison data
colnames(us_state_density)[1] = &quot;State&quot;
us_state_population= us_state_density[, c(&quot;State&quot;, &quot;census.percent.black&quot;, &quot;census.percent.white&quot;)]
SDIS_regression = merge(SDIS_states, us_state_population, by = &quot;State&quot;)

# calculate percent of prison population
SDIS_regression$percent.black.prison = SDIS_regression$incarcerated_black / SDIS_regression$incarcerated_total
SDIS_regression$percent.white.prison = SDIS_regression$incarcerated_white / SDIS_regression$incarcerated_total

# Calculate CODIS black and white proportions using previous regression
SDIS_regression$CODIS.black = model.all$coeff[1] + model.all$coeff[2] * SDIS_regression$census.percent.black + model.all$coeff[3] * SDIS_regression$percent.black.prison + model.all$coeff[4] + model.all$coeff[5]* SDIS_regression$census.percent.black + model.all$coeff[6] * SDIS_regression$percent.black

SDIS_regression$CODIS.white = model.all$coeff[1] + model.all$coeff[2] * SDIS_regression$census.percent.white + model.all$coeff[3] * SDIS_regression$percent.white.prison

SDIS_regression$source = &quot;Regression&quot;
SDIS_regression.trim = SDIS_regression[, c(&quot;State&quot;, &quot;CODIS.black&quot;, &quot;CODIS.white&quot;, &quot;source&quot;)]

# Prepare data for regression analysis for SDIS arrestees
SDIS_arrestees = SDIS_regression[-c(which(is.na(SDIS_regression$N_arrestees.SDIS))),]
SDIS_arrestees = SDIS_arrestees[, c(&quot;State&quot;, &quot;N_arrestees.SDIS&quot;, &quot;census.percent.black&quot;, &quot;census.percent.white&quot;, &quot;percent.black.prison&quot;, &quot;percent.white.prison&quot;, &quot;N_arrestees.NDIS&quot;)]

# Linear model for SDIS arrestees using census percent, prison percent, and number of people in NDIS as predictors
SDIS_arrestee = lm(N_arrestees.SDIS ~ census.percent.black + census.percent.white + percent.black.prison + percent.white.prison + N_arrestees.NDIS, data = SDIS_arrestees)
summary(SDIS_arrestee)

# Prepare data for regression analysis for SDIS offenders
SDIS_offenders = SDIS_regression[-c(which(is.na(SDIS_regression$N_offenders.SDIS))),]
SDIS_offenders = SDIS_offenders[, c(&quot;State&quot;, &quot;N_offenders.SDIS&quot;, &quot;census.percent.black&quot;, &quot;census.percent.white&quot;, &quot;percent.black.prison&quot;, &quot;percent.white.prison&quot;, &quot;N_offenders.NDIS&quot;)]

# Perform regression analysis for SDIS offenders
SDIS_offender = lm(N_offenders.SDIS ~ census.percent.black + census.percent.white + percent.black.prison + percent.white.prison + N_offenders.NDIS, data = SDIS_offenders)
summary(SDIS_offender)

# calculate regression prediction for each state
SDIS_regression$SDIS.arrestee.prediction = SDIS_arrestee$coeff[1] + SDIS_arrestee$coeff[2] * SDIS_regression$census.percent.black +
                                                             SDIS_arrestee$coeff[3] * SDIS_regression$census.percent.white +
                                                             SDIS_arrestee$coeff[4] * SDIS_regression$percent.black.prison +
                                                             SDIS_arrestee$coeff[5] * SDIS_regression$percent.white.prison +
                                                             SDIS_arrestee$coeff[6] * SDIS_regression$N_arrestees.NDIS

SDIS_regression$SDIS.offender.prediction = SDIS_offender$coeff[1] + SDIS_offender$coeff[2] * SDIS_regression$census.percent.black +
                                                             SDIS_offender$coeff[3] * SDIS_regression$census.percent.white +
                                                             SDIS_offender$coeff[4] * SDIS_regression$percent.black.prison +
                                                             SDIS_offender$coeff[5] * SDIS_regression$percent.white.prison +
                                                             SDIS_offender$coeff[6] * SDIS_regression$N_offenders.NDIS

# make sure no predictions are less than 0
SDIS_regression$SDIS.offender.prediction[SDIS_regression$SDIS.offender.prediction &lt; 0] = 0
SDIS_regression$SDIS.arrestee.prediction[SDIS_regression$SDIS.arrestee.prediction &lt; 0] = 0

all.arrestees.SDIS &lt;- SDIS_regression[which(!is.na(SDIS_regression$N_arrestees.SDIS)),]
all.offenders.SDIS &lt;- SDIS_regression[which(!is.na(SDIS_regression$N_offenders.SDIS)),]

# Plot predicted vs. actual SDIS arrestees
p1 = ggplot(data = all.arrestees.SDIS) +
  geom_point(aes(x = SDIS.arrestee.prediction, y = N_arrestees.SDIS, fill = State), size = 5, col = &quot;black&quot;, shape = 21) +
  geom_abline(intercept = 0, slope = 1, col = &quot;grey30&quot;, linetype = &quot;dashed&quot;, size = 1.5) +
  theme_classic() + xlab(&quot;Estimated SDIS arrestees&quot;) + ylab(&quot;SDIS arrestees&quot;) +
  guides(fill = guide_legend(override.aes = list(shape = 21))) +
  theme(legend.position = &quot;none&quot;)

# Plot predicted vs. actual SDIS offenders
p2 = ggplot(data = all.offenders.SDIS) +
  geom_point(aes(x = SDIS.offender.prediction, y = N_offenders.SDIS, fill = State), size = 5, col = &quot;black&quot;, shape = 21) +
  geom_abline(intercept = 0, slope = 1, col = &quot;grey30&quot;, linetype = &quot;dashed&quot;, size = 1.5) +
  theme_classic() + xlab(&quot;Estimated SDIS offenders&quot;) + ylab(&quot;SDIS offenders&quot;) +
  guides(fill = guide_legend(override.aes = list(shape = 21))) +
  theme(legend.position = &quot;none&quot;)

# Extract legend from one of the plots
leg = get_legend(ggplot(data = all.offenders.SDIS) +
  geom_point(aes(x = SDIS.offender.prediction, y = N_offenders.SDIS, fill = State), size = 5, col = &quot;black&quot;, shape = 21) +
  geom_abline(intercept = 0, slope = 1, col = &quot;grey30&quot;, linetype = &quot;dashed&quot;, size = 1.5) +
  theme_classic() + xlab(&quot;Estimated SDIS offenders&quot;) + ylab(&quot;SDIS offenders&quot;) +
  guides(fill = guide_legend(override.aes = list(shape = 21))) +
  theme(legend.position = &quot;bottom&quot;, axis.text.x = element_text(color = &quot;black&quot;, size = 16, angle = 0, hjust = .5, vjust = .5, face = &quot;plain&quot;),
        axis.text.y = element_text(color = &quot;black&quot;, size = 16, angle = 0, hjust = 1, vjust = 0, face = &quot;plain&quot;),  
        axis.title.x = element_text(color = &quot;black&quot;, size = 16, angle = 0, hjust = .5, vjust = 0, face = &quot;plain&quot;),
        axis.title.y = element_text(color = &quot;black&quot;, size = 16, angle = 90, hjust = .5, vjust = .5, face = &quot;plain&quot;),
        aspect.ratio = 1))

# Combine plots a and b into a grid with legend
p3 = plot_grid(p1, p2, ncol = 2)
plot_grid(NULL, p3, NULL, leg, nrow = 4, rel_heights = c(0, 1.5, 0.2, 0.5))</code></pre>
<p><img src="figure/regression.Rmd/SDIS_regression-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-SDIS_regression-1">
Past versions of SDIS_regression-1.png
</button>
</p>
<div id="fig-SDIS_regression-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/be5e7b513f85054b446ee8d634f99496d978dcd6/docs/figure/regression.Rmd/SDIS_regression-1.png" target="_blank">be5e7b5</a>
</td>
<td>
hcvw
</td>
<td>
2024-08-14
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>Murphy = read.csv(&quot;./data/Murphy_FOIA.csv&quot;) # FOIA data from Murphy

# Reshape Murphy data to wide format
Murphy_wide = reshape(Murphy, idvar = &quot;State&quot;, timevar = &quot;pop&quot;, direction = &quot;wide&quot;)
Murphy_wide = Murphy_wide[, c(&quot;State&quot;, &quot;value.Total&quot;, &quot;value.White&quot;, &quot;value.Black&quot;)]

# Prepare final dataset 
final.data = merge(SDIS_regression, Murphy_wide, by = &quot;State&quot;, all.x = TRUE)

# Calculate final estimates for Black and White populations in CODIS based on different sources
final.data = final.data[-c(which(final.data$State == &quot;Michigan&quot;)),]
for (i in 1:nrow(final.data)) {
  print(i)
  if (!is.na(final.data$value.Total[i])) {
    final.data$final.Black[i] = final.data$value.Total[i] * (final.data$value.Black[i] / 100)
    final.data$final.White[i] = final.data$value.Total[i] * (final.data$value.White[i] / 100)
    final.data$source[i] = &quot;Murphy&quot;
  } else if (!is.na(final.data$N_total.SDIS[i])) {
    final.data$final.Black[i] = (final.data$N_total.SDIS[i]) * final.data$CODIS.black[i]
    final.data$final.White[i] = (final.data$N_total.SDIS[i]) * final.data$CODIS.white[i]
    final.data$source[i] = &quot;SDIS+regression&quot;
  } else {
    final.data$final.Black[i] = (final.data$SDIS.arrestee.prediction[i] + final.data$SDIS.offender.prediction[i]) * final.data$CODIS.black[i]
    final.data$final.White[i] = (final.data$SDIS.arrestee.prediction[i] + final.data$SDIS.offender.prediction[i]) * final.data$CODIS.white[i]
    final.data$source[i] = &quot;Regression only&quot;
  }
}</code></pre>
<pre><code>[1] 1
[1] 2
[1] 3
[1] 4
[1] 5
[1] 6
[1] 7
[1] 8
[1] 9
[1] 10
[1] 11
[1] 12
[1] 13
[1] 14
[1] 15
[1] 16
[1] 17
[1] 18
[1] 19
[1] 20
[1] 21
[1] 22
[1] 23
[1] 24
[1] 25
[1] 26
[1] 27
[1] 28
[1] 29
[1] 30
[1] 31
[1] 32
[1] 33
[1] 34
[1] 35
[1] 36
[1] 37
[1] 38
[1] 39
[1] 40
[1] 41
[1] 42
[1] 43
[1] 44
[1] 45
[1] 46
[1] 47
[1] 48</code></pre>
<pre class="r"><code># Plot the final estimates for Black and White populations in CODIS
ggplot(final.data) +
  geom_point(aes(x = State, y = final.Black, fill = source, shape = &quot;Black&quot;), size = 2.5, col = &quot;black&quot;) +
  geom_point(aes(x = State, y = final.White, fill = source, shape = &quot;White&quot;), size = 2.5, col = &quot;black&quot;) +
  scale_fill_manual(name = &quot;Source&quot;, labels = c(&quot;Murphy&quot;, &quot;Regression only&quot;, &quot;SDIS+regression&quot;), values = c(&quot;#9A77CF&quot;, &quot;#EC4176&quot;, &quot;#FFA45E&quot;)) +
  scale_shape_manual(name = &quot;Race&quot;, labels = c(&quot;Black&quot;, &quot;White&quot;), values = c(21, 24)) +
  theme_bw() +
  guides(fill = guide_legend(override.aes = list(shape = 21))) +
  theme(axis.text.x = element_text(size = 8, angle = 90, vjust = 0.5, hjust = 1)) +
  ylab(&quot;Number of People in CODIS&quot;)</code></pre>
<p><img src="figure/regression.Rmd/final_data-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-final_data-1">
Past versions of final_data-1.png
</button>
</p>
<div id="fig-final_data-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/be5e7b513f85054b446ee8d634f99496d978dcd6/docs/figure/regression.Rmd/final_data-1.png" target="_blank">be5e7b5</a>
</td>
<td>
hcvw
</td>
<td>
2024-08-14
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>final.data.sf = st_as_sf(final.data)
final.data.sf = final.data.sf %&gt;%
  tigris::shift_geometry()

ggplot() +
  geom_sf(data = final.data.sf$geometry, aes(fill = final.data.sf$final.Black),color = NA) + 
  geom_sf(data = final.data.sf$geometry, color = &quot;black&quot;,lwd = 0.1,alpha = 0) +
  theme_void(base_size = 11) + 
  scale_fill_viridis(option = &quot;magma&quot;, direction = -1)+
  labs(fill = &quot;Number of Black people in CODIS&quot;) + 
  theme(plot.margin = unit(rep(0.5, 4), &quot;cm&quot;)) +
  theme(legend.key.height= unit(0.2, &#39;cm&#39;), legend.key.width= unit(0.2, &#39;cm&#39;),
        legend.title=element_text(size=6),  legend.text=element_text(size=6)) </code></pre>
<p><img src="figure/regression.Rmd/final_data-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-final_data-2">
Past versions of final_data-2.png
</button>
</p>
<div id="fig-final_data-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/be5e7b513f85054b446ee8d634f99496d978dcd6/docs/figure/regression.Rmd/final_data-2.png" target="_blank">be5e7b5</a>
</td>
<td>
hcvw
</td>
<td>
2024-08-14
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>ggplot() +
  geom_sf(data = final.data.sf$geometry, aes(fill = final.data.sf$final.Black/(final.data.sf$final.Black + final.data.sf$final.White)),color = NA) + 
  geom_sf(data = final.data.sf$geometry, color = &quot;black&quot;,lwd = 0.1,alpha = 0) +
  theme_void(base_size = 11) + 
  scale_fill_viridis(option = &quot;magma&quot;, direction = -1)+
  labs(fill = &quot;Percent of people in CODIS that are Black&quot;) + 
  theme(plot.margin = unit(rep(0.5, 4), &quot;cm&quot;)) +
  theme(legend.key.height= unit(0.2, &#39;cm&#39;), legend.key.width= unit(0.2, &#39;cm&#39;),
        legend.title=element_text(size=6),  legend.text=element_text(size=6)) </code></pre>
<p><img src="figure/regression.Rmd/final_data-3.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-final_data-3">
Past versions of final_data-3.png
</button>
</p>
<div id="fig-final_data-3" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/be5e7b513f85054b446ee8d634f99496d978dcd6/docs/figure/regression.Rmd/final_data-3.png" target="_blank">be5e7b5</a>
</td>
<td>
hcvw
</td>
<td>
2024-08-14
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>final.data[,c(&quot;State&quot;,&quot;final.Black&quot;,&quot;final.White&quot;,&quot;source&quot;)]</code></pre>
<pre><code>            State final.Black final.White          source
1         Alabama 181118.5149  217600.769 SDIS+regression
2          Alaska   3815.5604   27017.748 Regression only
3         Arizona  50414.9656  219982.541 Regression only
4        Arkansas   4031.2855    8680.932 SDIS+regression
5      California 473373.9990  819407.624          Murphy
6        Colorado  57866.4208  262106.908 SDIS+regression
7        Delaware  10505.3095   12521.567 Regression only
8         Florida 475434.7840  829309.538          Murphy
9         Georgia 206442.0982  181496.282 SDIS+regression
10         Hawaii      0.0000       0.000 Regression only
11          Idaho    963.4824   34101.874 SDIS+regression
12       Illinois 253303.7558  305785.832 SDIS+regression
13        Indiana  80005.6400  215399.800          Murphy
14           Iowa  23547.7791  129417.794 Regression only
15         Kansas  47971.5739  228957.430 Regression only
16       Kentucky  39635.3249  206063.727 Regression only
17      Louisiana 432013.8926  338844.041 SDIS+regression
18          Maine   1281.0330   30482.016          Murphy
19       Maryland 105523.8679   63185.108 Regression only
20  Massachusetts  29089.9767   82413.819 Regression only
22      Minnesota  37914.2174  115906.979 SDIS+regression
23    Mississippi  77616.9619   62226.769 SDIS+regression
24       Missouri 103504.8306  309407.963 SDIS+regression
25        Montana    641.1110   28312.414 SDIS+regression
26       Nebraska  10883.2023   42568.168 Regression only
27         Nevada  42937.8560  116401.844          Murphy
28  New Hampshire   1150.5349   25032.868 Regression only
29     New Jersey  12389.6261   11436.627 SDIS+regression
30     New Mexico   7904.7437  125143.981 Regression only
31       New York 238663.9932  242441.361 Regression only
32 North Carolina 151156.0304  193565.650 SDIS+regression
33   North Dakota   3723.8156   30201.743 Regression only
34           Ohio 296953.4390  619494.658 Regression only
35       Oklahoma  37023.9187  123653.578 Regression only
36         Oregon  12540.8998  185331.823 Regression only
37   Pennsylvania 138395.0744  254930.252 Regression only
38   Rhode Island   5961.4416    8911.275 SDIS+regression
39 South Carolina  91029.7856   91493.358 SDIS+regression
40   South Dakota   4056.0000   45156.800          Murphy
41      Tennessee 154617.8926  317725.504 Regression only
42          Texas 279646.6350  358447.405          Murphy
43           Utah   5888.7593   94268.650 Regression only
44        Vermont   2051.7990   38945.970 Regression only
45       Virginia 218711.3900  275687.781 SDIS+regression
46     Washington  31472.5629  235805.829 SDIS+regression
47  West Virginia   4234.0180   47855.252 SDIS+regression
48      Wisconsin  91303.4332  266299.611 Regression only
49        Wyoming    881.2959   24927.548 Regression only</code></pre>
<pre class="r"><code>write.csv(final.data, &quot;./data/final_CODIS_data.csv&quot;)</code></pre>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.3 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

time zone: America/New_York
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] sf_1.0-14         viridis_0.6.4     viridisLite_0.4.2 ggpubr_0.6.0     
 [5] cowplot_1.1.1     tidycensus_1.4.4  sandwich_3.1-0    jtools_2.2.2     
 [9] knitr_1.46        lubridate_1.9.3   forcats_1.0.0     stringr_1.5.0    
[13] dplyr_1.1.4       purrr_1.0.2       tidyr_1.3.0       tibble_3.2.1     
[17] ggplot2_3.5.0     tidyverse_2.0.0   readr_2.1.5       workflowr_1.7.1  

loaded via a namespace (and not attached):
 [1] tidyselect_1.2.0   farver_2.1.1       fastmap_1.1.1      promises_1.2.1    
 [5] digest_0.6.33      timechange_0.2.0   lifecycle_1.0.4    ellipsis_0.3.2    
 [9] processx_3.8.4     magrittr_2.0.3     compiler_4.3.1     rlang_1.1.3       
[13] sass_0.4.7         tools_4.3.1        utf8_1.2.4         yaml_2.3.7        
[17] ggsignif_0.6.4     labeling_0.4.2     curl_5.0.2         classInt_0.4-9    
[21] xml2_1.3.5         abind_1.4-5        KernSmooth_2.23-22 withr_3.0.0       
[25] grid_4.3.1         fansi_1.0.6        git2r_0.33.0       e1071_1.7-13      
[29] colorspace_2.1-0   scales_1.3.0       cli_3.6.2          rmarkdown_2.25    
[33] crayon_1.5.2       generics_0.1.3     rstudioapi_0.15.0  httr_1.4.7        
[37] tzdb_0.4.0         DBI_1.1.3          cachem_1.0.8       proxy_0.4-27      
[41] pander_0.6.5       rvest_1.0.3        vctrs_0.6.5        tigris_2.0.3      
[45] jsonlite_1.8.8     carData_3.0-5      car_3.1-2          callr_3.7.3       
[49] hms_1.1.3          rstatix_0.7.2      jquerylib_0.1.4    units_0.8-3       
[53] glue_1.7.0         ps_1.7.6           stringi_1.7.12     gtable_0.3.3      
[57] later_1.3.1        munsell_0.5.0      pillar_1.9.0       rappdirs_0.3.3    
[61] htmltools_0.5.6    R6_2.5.1           rprojroot_2.0.3    evaluate_0.21     
[65] lattice_0.21-8     highr_0.10         backports_1.4.1    broom_1.0.5       
[69] httpuv_1.6.11      bslib_0.5.1        class_7.3-22       Rcpp_1.0.11       
[73] uuid_1.1-1         gridExtra_2.3      whisker_0.4.1      xfun_0.44         
[77] fs_1.6.3           zoo_1.8-12         getPass_0.2-4      pkgconfig_2.0.3   </code></pre>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
https://docs.mathjax.org/en/latest/web/configuration.html. This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>

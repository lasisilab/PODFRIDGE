<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Junhui He" />


<title>Regression to predict CODIS database sizes and racial proportions</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/main/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">PODFRIDGE</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/lasisilab/PODFRIDGE">
    <span class="fab fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Regression to predict CODIS database sizes
and racial proportions</h1>
<h4 class="author">Junhui He</h4>
<h4 class="date">2025-07-04 23:06:16</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span>
workflowr <span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2025-07-04
</p>
<p>
<strong>Checks:</strong> <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>PODFRIDGE/</code> <span
class="glyphicon glyphicon-question-sign" aria-hidden="true"
title="This is the local directory in which the code in this file was executed.">
</span>
</p>
<p>
This reproducible <a href="https://rmarkdown.rstudio.com">R Markdown</a>
analysis was created with <a
  href="https://github.com/workflowr/workflowr">workflowr</a> (version
1.7.1). The <em>Checks</em> tab describes the reproducibility checks
that were applied when the results were created. The <em>Past
versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date
</a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git
repository, you know the exact version of the code that produced these
results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the
global environment can affect the analysis in your R Markdown file in
unknown ways. For reproduciblity it’s best to always run the code in an
empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20230302code">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Seed:</strong>
<code>set.seed(20230302)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20230302code"
class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20230302)</code> was run prior to running
the code in the R Markdown file. Setting a seed ensures that any results
that rely on randomness, e.g. subsampling or permutations, are
reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Session information:</strong>
recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package
versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be
confident that you successfully produced the results during this
run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr
project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomlasisilabPODFRIDGEtree2d5d98e206c16975dfc06a8233da72200365dc3atargetblank2d5d98ea">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Repository version:</strong>
<a href="https://github.com/lasisilab/PODFRIDGE/tree/2d5d98e206c16975dfc06a8233da72200365dc3a" target="_blank">2d5d98e</a>
</a>
</p>
</div>
<div
id="strongRepositoryversionstrongahrefhttpsgithubcomlasisilabPODFRIDGEtree2d5d98e206c16975dfc06a8233da72200365dc3atargetblank2d5d98ea"
class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development
and connecting the code version to the results is critical for
reproducibility.
</p>
<p>
The results in this page were generated with repository version
<a href="https://github.com/lasisilab/PODFRIDGE/tree/2d5d98e206c16975dfc06a8233da72200365dc3a" target="_blank">2d5d98e</a>.
See the <em>Past versions</em> tab to see a history of the changes made
to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for
the analysis have been committed to Git prior to generating the results
(you can use <code>wflow_publish</code> or
<code>wflow_git_commit</code>). workflowr only checks the R Markdown
file, but you know if there are other scripts or data files that it
depends on. Below is the status of the Git repository when the results
were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .DS_Store
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/
    Ignored:    analysis/.DS_Store
    Ignored:    code/.DS_Store
    Ignored:    data/.DS_Store
    Ignored:    output/.DS_Store

Untracked files:
    Untracked:  data/Murphy_combined_data.csv
    Untracked:  data/internal/
    Untracked:  data/raw/
    Untracked:  data/regression_data/Murphy_combined_data.csv
    Untracked:  output/SDIS_racial_composition.csv
    Untracked:  output/pmf_sibling_counts.csv
    Untracked:  output/pmf_sibling_counts.png

Unstaged changes:
    Modified:   analysis/forensic_databases.Rmd
    Modified:   analysis/racial_proportion.Rmd
    Modified:   analysis/regression.Rmd
    Modified:   data/final_CODIS_data.csv

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not
included in this status report because it is ok for generated content to
have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">
<p>
These are the previous versions of the repository in which changes were
made to the R Markdown (<code>analysis/codis_regression.Rmd</code>) and
HTML (<code>docs/codis_regression.html</code>) files. If you’ve
configured a remote Git repository (see <code>?wflow_git_remote</code>),
click on the hyperlinks in the table below to view the files as they
were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/2d5d98e206c16975dfc06a8233da72200365dc3a/analysis/codis_regression.Rmd" target="_blank">2d5d98e</a>
</td>
<td>
Junhui He
</td>
<td>
2025-07-04
</td>
<td>
wflow_publish("analysis/codis_regression.Rmd")
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lasisilab/PODFRIDGE/bf233c1982ebfac630984d3d9d72bea774378e51/docs/codis_regression.html" target="_blank">bf233c1</a>
</td>
<td>
Junhui He
</td>
<td>
2025-06-21
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/289c58af6dfde632630b03222da1ad57d46e9cee/analysis/codis_regression.Rmd" target="_blank">289c58a</a>
</td>
<td>
Junhui He
</td>
<td>
2025-06-21
</td>
<td>
modify codis regression
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lasisilab/PODFRIDGE/6dfd60aa6ca9b6621cbfc2dbe859ec6772e58804/docs/codis_regression.html" target="_blank">6dfd60a</a>
</td>
<td>
Junhui He
</td>
<td>
2025-06-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/0a2a52ac49033a1e4af1d33d2d3fa49e8c722f35/analysis/codis_regression.Rmd" target="_blank">0a2a52a</a>
</td>
<td>
Junhui He
</td>
<td>
2025-06-18
</td>
<td>
modify codis regression file
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lasisilab/PODFRIDGE/3dfd5e12189eadef6caf4176b3e0551ada7c22e4/docs/codis_regression.html" target="_blank">3dfd5e1</a>
</td>
<td>
Junhui He
</td>
<td>
2025-06-17
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/0328266b7d91d49df0b75e044e0b4ad326932be3/analysis/codis_regression.Rmd" target="_blank">0328266</a>
</td>
<td>
Junhui He
</td>
<td>
2025-06-17
</td>
<td>
recreate a document for regression predictions
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="introduction" class="section level1">
<h1>1 Introduction</h1>
<p>The Combined DNA Index System (CODIS) is a national database of DNA
profiles maintained by the FBI. It includes profiles from convicted
offenders, arrestees, and forensic samples collected from crime scenes.
CODIS consists of two indexing systems: the State DNA Index System
(SDIS) and the National DNA Index System (NDIS). The racial composition
of the forensic database has raised concerns, particularly due to the
overrepresentation of Black individuals relative to their proportion in
the U.S. population.</p>
<p>To analyze the racial demographics of the forensic database at the
state level, we require two key pieces of information: (1) the racial
breakdown of forensic samples in each state, and (2) the total size of
the forensic database in each state. However, since racial composition
data is not publicly available for all states, we must estimate the
racial proportions using the data that is available.</p>
<p>The available data sources include:</p>
<ul>
<li>Direct data on the racial composition in SDIS, from a Freedom of
Information Act (FOIA) request conducted by Muprhy and Tong (2020) for
the following seven states: California, Florida, Indiana, Maine, Nevada,
South Dakota, and Texas. [1]</li>
<li>The total number and the racial composition of incarecated people in
prison at each state. Klein et al. (2023) [2] provided the prison data
for each US state except for Michigan state. For the state of Michigan,
this data was pulled from a separate source [5].</li>
<li>The number of people in the State DNA Indexing System (SDIS) and the
National DNA Indexing System (NDIS). NDIS data is publicly available for
all 50 states [3], whereas SDIS data is only available on a
state-by-state basis and is obtained from internet searches.</li>
<li>The U.S. Census data for each state [4], which provides the total
population and the racial composition of the general population. This
data is available through the U.S. Census Bureau’s API.</li>
</ul>
<p>Based on the available data, the total size of the forensic database
in each state is determined using the number of individuals in SDIS when
such data is available. For states without SDIS data, the number of
individuals in NDIS is used instead. To estimate the racial composition
of each state’s forensic database, we apply a regression model that
incorporates two factors: the racial composition of the general
population and the racial composition of the prison population within
the state.</p>
<p>The plot below illustrates which data sources are available for each
state:</p>
<div id="load-census-data-from-tidycensus" class="section level2">
<h2>Load Census data from <code>tidycensus</code></h2>
<pre class="r"><code># Load census data for each state from `tidycensus`
# P1_002N is the total population, P1_003N is the total White population, and P1_004N is the total Black population
us_state_density &lt;- get_decennial(
  geography = &quot;state&quot;,
  variables = c(all = &quot;P1_002N&quot;, census.num.white = &quot;P1_003N&quot;, census.num.black = &quot;P1_004N&quot;),
  year = 2020,
  geometry = TRUE,
  keep_geo_vars = TRUE
)</code></pre>
</div>
<div id="load-ndis-and-sdis-data" class="section level2">
<h2>Load NDIS and SDIS data</h2>
<p>The NDIS and SDIS are stored in <code>data/raw/NDIS.csv</code> and
<code>data/raw/SDIS.csv</code>, respectively.</p>
<pre class="r"><code># Read NDIS and SDIS data
NDIS = read.csv(&quot;./data/raw/NDIS.csv&quot;)       # National DNA Index System data
SDIS = read.csv(&quot;./data/raw/SDIS.csv&quot;)       # State DNA Indexing System data

SDIS$N_total = ifelse(is.na(SDIS$N_total), SDIS$N_arrestees + SDIS$N_offenders, SDIS$N_total)

# Merge NDIS and SDIS datasets by state
NDIS_SDIS = merge(NDIS, SDIS, by = &quot;State&quot;)

# Rename columns to distinguish between NDIS and SDIS data
colnames(NDIS_SDIS) &lt;- gsub(&#39;.x&#39;,&#39;.NDIS&#39;, names(NDIS_SDIS))
colnames(NDIS_SDIS) &lt;- gsub(&#39;.y&#39;,&#39;.SDIS&#39;, names(NDIS_SDIS))

NDIS_SDIS$N_total.CODIS = ifelse(!is.na(NDIS_SDIS$N_total.SDIS), NDIS_SDIS$N_total.SDIS, NDIS_SDIS$N_total.NDIS)</code></pre>
<p><img src="figure/codis_regression.Rmd/data-merge-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div
id="models-to-predict-the-racial-composition-of-the-forensic-database"
class="section level1">
<h1>2 Models to predict the racial composition of the forensic
database</h1>
<p>For states without SDIS racial composition data, we construct a
multinomial regression model using stick-breaking techniques to estimate
the racial composition of SDIS profiles. In the stick-breaking
technique, we divide the US races into three types, black + white +
other, and separately estimate the percent of white people in all people
<span class="math inline">\(p_{1}\)</span> and the percent of black
people in non-white people <span class="math inline">\(p_{2}\)</span>.
Then the racial breakdown is given by <span
class="math display">\[CODIS\_Prop_{white}=p_1, \quad
CODIS\_Prop_{black}=(1-p_1)p_2,\quad
CODIS\_Prop_{other}=(1-p_1)(1-p_2).\]</span> We use the following
binomial regression models to estimate the racial composition of SDIS
profiles: <span class="math display">\[P(\text{a person in CODIS is
white}) = g(\beta_{10} + \beta_{11}*Census\_Prop_{white}+
\beta_{12}*Prison\_Prop_{white}),\]</span> and <span
class="math display">\[P(\text{a non-white person in CODIS is black}) =
g(\beta_{20} + \beta_{21}*Census\_Prop_{black\mid nonwhite}+
\beta_{22}*Prison\_Prop_{black \mid nonwhite}),\]</span> where <span
class="math inline">\(g(x)=\frac{\exp(x)}{1+\exp(x)}\)</span> is the
logit link function. Consequently, the number of the corresponding
racial groups in SDIS follows a binomial distribution with the trial
number being the total number of people or non-white people in SDIS, and
the success probability being the above estimated racial proportions.
The independent variables are the racial proportions of population from
the census database and the racial proportions of incarcerated people
from the prison database.</p>
</div>
<div
id="regression-to-estimate-the-racial-composition-of-the-sdis-database."
class="section level1">
<h1>3 Regression to estimate the racial composition of the SDIS
database.</h1>
<div id="load-regression-data" class="section level2">
<h2>Load regression data</h2>
<p>Murphy and Tong processed FOIA data is stored in
<code>data/internal/murphy_processed.csv</code>. The prison and census
combined data is stored in
<code>data/internal/prison_census_combined.csv</code>. The following
code reads the data and preprocesses it to obtain the training and test
data for the regression model. The training data consists of seven
states with FOIA data, and the test data consists of all other
states.</p>
<pre class="r"><code># read and preprocess data
# read data
response_data_path = file.path(&#39;./data/internal&#39;, &#39;murphy_processed.csv&#39;)
predictor_data_path = file.path(&#39;./data/internal&#39;, &#39;prison_census_combined.csv&#39;)

response_data = read.csv(response_data_path) # Murphy &amp; Tong data
predictor_data = read.csv(predictor_data_path) # Census and prison data
predictor_data[is.na(predictor_data)] = 0

idx = sapply(response_data$state, function(x) {which(x == predictor_data$State)}) # obtain the index of seven FOIA states

# calculate the response values
mt_data = data.frame(
  white = response_data$mt.num.white,
  black = response_data$mt.num.black,
  total = response_data$mt.num.total,
  nonwhite = response_data$mt.num.total - response_data$mt.num.white,
  other = response_data$mt.num.other
)

# calculate the predictor values
x = data.frame(
  census.percent.white = predictor_data$census.percent.white,
  census.percent.black = predictor_data$census.percent.black,
  incarc.percent.white = predictor_data$incarcerated_white / (predictor_data$incarcerated_total - predictor_data$incarcerated_unknown),
  incarc.percent.black = predictor_data$incarcerated_black / (predictor_data$incarcerated_total - predictor_data$incarcerated_unknown)
)

x$census.percent.black.remain = x$census.percent.black / (1 - x$census.percent.white)
x$incarc.percent.black.remain = x$incarc.percent.black / (1 - x$incarc.percent.white)

# create training data and test data
train_data = x[idx,]
test_data = x[-idx,]</code></pre>
</div>
<div id="coeffient-estimation-and-wald-test" class="section level2">
<h2>Coeffient estimation and Wald test</h2>
<p>We estimate the linear coefficients <span
class="math inline">\(\beta\)</span> of the binomial logistic regression
for black Americans and white Americans using <code>glm()</code>
function and do a Wald test on the beta coefficients. The <span
class="math inline">\(p\)</span>-values show that these coefficients are
all statistically significant.</p>
<pre class="r"><code>summary(binomial_regression.white)</code></pre>
<pre><code>
Call:
glm(formula = cbind(mt_data$white, mt_data$nonwhite) ~ census.percent.white + 
    incarc.percent.white, family = binomial, data = train_data)

Coefficients:
                     Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)          -2.02116    0.00985 -205.19   &lt;2e-16 ***
census.percent.white  0.41899    0.03027   13.84   &lt;2e-16 ***
incarc.percent.white  4.86338    0.02747  177.05   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 624973  on 6  degrees of freedom
Residual deviance: 100696  on 4  degrees of freedom
AIC: 100792

Number of Fisher Scoring iterations: 4</code></pre>
<pre class="r"><code>summary(binomial_regression.black)</code></pre>
<pre><code>
Call:
glm(formula = cbind(mt_data$black, mt_data$other) ~ census.percent.black.remain + 
    incarc.percent.black.remain, family = binomial, data = train_data)

Coefficients:
                             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                 -4.147885   0.008485 -488.85   &lt;2e-16 ***
census.percent.black.remain -1.175214   0.027708  -42.41   &lt;2e-16 ***
incarc.percent.black.remain  9.084829   0.033111  274.38   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 925038  on 6  degrees of freedom
Residual deviance:  44756  on 4  degrees of freedom
AIC: 44843

Number of Fisher Scoring iterations: 4</code></pre>
<p>The following plot showing the estimated racial composition using the
regression model vs. the true values for the states with available data.
We also plot a difference plot (also known as a Bland-Altman plot).</p>
<p><img src="figure/codis_regression.Rmd/Goodness-of-Fit-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Goodness-of-Fit-1">
Past versions of Goodness-of-Fit-1.png
</button>
</p>
<div id="fig-Goodness-of-Fit-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/bf233c1982ebfac630984d3d9d72bea774378e51/docs/figure/codis_regression.Rmd/Goodness-of-Fit-1.png" target="_blank">bf233c1</a>
</td>
<td>
Junhui He
</td>
<td>
2025-06-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/3dfd5e12189eadef6caf4176b3e0551ada7c22e4/docs/figure/codis_regression.Rmd/Goodness-of-Fit-1.png" target="_blank">3dfd5e1</a>
</td>
<td>
Junhui He
</td>
<td>
2025-06-17
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><img src="figure/codis_regression.Rmd/Goodness-of-Fit-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-Goodness-of-Fit-2">
Past versions of Goodness-of-Fit-2.png
</button>
</p>
<div id="fig-Goodness-of-Fit-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/bf233c1982ebfac630984d3d9d72bea774378e51/docs/figure/codis_regression.Rmd/Goodness-of-Fit-2.png" target="_blank">bf233c1</a>
</td>
<td>
Junhui He
</td>
<td>
2025-06-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/3dfd5e12189eadef6caf4176b3e0551ada7c22e4/docs/figure/codis_regression.Rmd/Goodness-of-Fit-2.png" target="_blank">3dfd5e1</a>
</td>
<td>
Junhui He
</td>
<td>
2025-06-17
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="final-results" class="section level1">
<h1>4 Final results</h1>
<p>Using the above regression models, we make predictions of the racial
composition in SDIS by state and determine the total number of people by
SDIS or NDIS. Then the number of people for each racial group in the
forensic database is calculated by <span class="math inline">\(N_{race}
= N_{total} * Proportion_{race}\)</span>. The plot below shows our
estimates for each state, colored by the data source used for each
state. The number of Black people in the database are indicated with
circles and the number of White people is indicated by triangles.</p>
<p><img src="figure/codis_regression.Rmd/final-data-1.png" width="1920" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-final-data-1">
Past versions of final-data-1.png
</button>
</p>
<div id="fig-final-data-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/bf233c1982ebfac630984d3d9d72bea774378e51/docs/figure/codis_regression.Rmd/final-data-1.png" target="_blank">bf233c1</a>
</td>
<td>
Junhui He
</td>
<td>
2025-06-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/6dfd60aa6ca9b6621cbfc2dbe859ec6772e58804/docs/figure/codis_regression.Rmd/final-data-1.png" target="_blank">6dfd60a</a>
</td>
<td>
Junhui He
</td>
<td>
2025-06-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/3dfd5e12189eadef6caf4176b3e0551ada7c22e4/docs/figure/codis_regression.Rmd/final-data-1.png" target="_blank">3dfd5e1</a>
</td>
<td>
Junhui He
</td>
<td>
2025-06-17
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="sdis-racial-composition-by-state" class="section level2">
<h2>SDIS racial composition by state</h2>
<p>The table below reports the estimates for the racial composition and
the number of people for each racial group in SDIS by state, along with
the source of the data is below:</p>
<pre class="r"><code>final.df = final.data[,c(&quot;State&quot;,&quot;SDIS.black&quot;,&quot;SDIS.white&quot;,&quot;SDIS.num.Black&quot;,&quot;SDIS.num.White&quot;,&quot;category&quot;)]
colnames(final.df) = c(&quot;State&quot;,&quot;SDIS.percent.black&quot;,&quot;SDIS.percent.white&quot;,&quot;SDIS.num.black&quot;, &quot;SDIS.num.white&quot;, &quot;Category&quot;)
kable(final.df, caption = &quot;Estimated racial composition of SDIS by state&quot;)</code></pre>
<table>
<caption>Estimated racial composition of SDIS by state</caption>
<colgroup>
<col width="15%" />
<col width="19%" />
<col width="19%" />
<col width="15%" />
<col width="15%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">State</th>
<th align="right">SDIS.percent.black</th>
<th align="right">SDIS.percent.white</th>
<th align="right">SDIS.num.black</th>
<th align="right">SDIS.num.white</th>
<th align="left">Category</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alabama</td>
<td align="right">0.371</td>
<td align="right">0.621</td>
<td align="right">133560</td>
<td align="right">223560</td>
<td align="left">SDIS+NDIS</td>
</tr>
<tr class="even">
<td align="left">Alaska</td>
<td align="right">0.027</td>
<td align="right">0.561</td>
<td align="right">2137</td>
<td align="right">44401</td>
<td align="left">SDIS+NDIS</td>
</tr>
<tr class="odd">
<td align="left">Arizona</td>
<td align="right">0.049</td>
<td align="right">0.540</td>
<td align="right">23514</td>
<td align="right">259129</td>
<td align="left">NDIS only</td>
</tr>
<tr class="even">
<td align="left">Arkansas</td>
<td align="right">0.252</td>
<td align="right">0.741</td>
<td align="right">3080</td>
<td align="right">9056</td>
<td align="left">SDIS+NDIS</td>
</tr>
<tr class="odd">
<td align="left">California</td>
<td align="right">0.171</td>
<td align="right">0.296</td>
<td align="right">575484</td>
<td align="right">996159</td>
<td align="left">Murphy and Tong</td>
</tr>
<tr class="even">
<td align="left">Colorado</td>
<td align="right">0.062</td>
<td align="right">0.580</td>
<td align="right">30949</td>
<td align="right">289519</td>
<td align="left">SDIS+NDIS</td>
</tr>
<tr class="odd">
<td align="left">Connecticut</td>
<td align="right">0.404</td>
<td align="right">0.412</td>
<td align="right">8080</td>
<td align="right">8240</td>
<td align="left">SDIS+NDIS</td>
</tr>
<tr class="even">
<td align="left">Delaware</td>
<td align="right">0.414</td>
<td align="right">0.579</td>
<td align="right">9399</td>
<td align="right">13146</td>
<td align="left">NDIS only</td>
</tr>
<tr class="odd">
<td align="left">Florida</td>
<td align="right">0.352</td>
<td align="right">0.614</td>
<td align="right">603289</td>
<td align="right">1052328</td>
<td align="left">Murphy and Tong</td>
</tr>
<tr class="even">
<td align="left">Georgia</td>
<td align="right">0.487</td>
<td align="right">0.497</td>
<td align="right">169060</td>
<td align="right">172531</td>
<td align="left">SDIS+NDIS</td>
</tr>
<tr class="odd">
<td align="left">Hawaii</td>
<td align="right">0.018</td>
<td align="right">0.320</td>
<td align="right">751</td>
<td align="right">13345</td>
<td align="left">NDIS only</td>
</tr>
<tr class="even">
<td align="left">Idaho</td>
<td align="right">0.005</td>
<td align="right">0.886</td>
<td align="right">195</td>
<td align="right">34554</td>
<td align="left">SDIS+NDIS</td>
</tr>
<tr class="odd">
<td align="left">Illinois</td>
<td align="right">0.509</td>
<td align="right">0.451</td>
<td align="right">350852</td>
<td align="right">310873</td>
<td align="left">SDIS+NDIS</td>
</tr>
<tr class="even">
<td align="left">Indiana</td>
<td align="right">0.260</td>
<td align="right">0.700</td>
<td align="right">116740</td>
<td align="right">314300</td>
<td align="left">Murphy and Tong</td>
</tr>
<tr class="odd">
<td align="left">Iowa</td>
<td align="right">0.160</td>
<td align="right">0.813</td>
<td align="right">24764</td>
<td align="right">125834</td>
<td align="left">NDIS only</td>
</tr>
<tr class="even">
<td align="left">Kansas</td>
<td align="right">0.159</td>
<td align="right">0.835</td>
<td align="right">37754</td>
<td align="right">198267</td>
<td align="left">NDIS only</td>
</tr>
<tr class="odd">
<td align="left">Kentucky</td>
<td align="right">0.110</td>
<td align="right">0.885</td>
<td align="right">26520</td>
<td align="right">213364</td>
<td align="left">NDIS only</td>
</tr>
<tr class="even">
<td align="left">Louisiana</td>
<td align="right">0.518</td>
<td align="right">0.472</td>
<td align="right">362402</td>
<td align="right">330220</td>
<td align="left">SDIS+NDIS</td>
</tr>
<tr class="odd">
<td align="left">Maine</td>
<td align="right">0.039</td>
<td align="right">0.928</td>
<td align="right">1467</td>
<td align="right">34915</td>
<td align="left">Murphy and Tong</td>
</tr>
<tr class="even">
<td align="left">Maryland</td>
<td align="right">0.648</td>
<td align="right">0.333</td>
<td align="right">95776</td>
<td align="right">49218</td>
<td align="left">SDIS+NDIS</td>
</tr>
<tr class="odd">
<td align="left">Massachusetts</td>
<td align="right">0.209</td>
<td align="right">0.582</td>
<td align="right">34313</td>
<td align="right">95550</td>
<td align="left">NDIS only</td>
</tr>
<tr class="even">
<td align="left">Michigan</td>
<td align="right">0.366</td>
<td align="right">0.626</td>
<td align="right">213259</td>
<td align="right">364754</td>
<td align="left">NDIS only</td>
</tr>
<tr class="odd">
<td align="left">Minnesota</td>
<td align="right">0.267</td>
<td align="right">0.702</td>
<td align="right">48060</td>
<td align="right">126360</td>
<td align="left">SDIS+NDIS</td>
</tr>
<tr class="even">
<td align="left">Mississippi</td>
<td align="right">0.477</td>
<td align="right">0.510</td>
<td align="right">56286</td>
<td align="right">60180</td>
<td align="left">SDIS+NDIS</td>
</tr>
<tr class="odd">
<td align="left">Missouri</td>
<td align="right">0.188</td>
<td align="right">0.805</td>
<td align="right">75200</td>
<td align="right">322000</td>
<td align="left">SDIS+NDIS</td>
</tr>
<tr class="even">
<td align="left">Montana</td>
<td align="right">0.005</td>
<td align="right">0.877</td>
<td align="right">161</td>
<td align="right">28313</td>
<td align="left">SDIS+NDIS</td>
</tr>
<tr class="odd">
<td align="left">Nebraska</td>
<td align="right">0.200</td>
<td align="right">0.688</td>
<td align="right">11613</td>
<td align="right">39949</td>
<td align="left">NDIS only</td>
</tr>
<tr class="even">
<td align="left">Nevada</td>
<td align="right">0.256</td>
<td align="right">0.694</td>
<td align="right">62720</td>
<td align="right">170030</td>
<td align="left">Murphy and Tong</td>
</tr>
<tr class="odd">
<td align="left">New Hampshire</td>
<td align="right">0.032</td>
<td align="right">0.923</td>
<td align="right">607</td>
<td align="right">17518</td>
<td align="left">NDIS only</td>
</tr>
<tr class="even">
<td align="left">New Jersey</td>
<td align="right">0.618</td>
<td align="right">0.335</td>
<td align="right">20206</td>
<td align="right">10953</td>
<td align="left">SDIS+NDIS</td>
</tr>
<tr class="odd">
<td align="left">New Mexico</td>
<td align="right">0.046</td>
<td align="right">0.900</td>
<td align="right">6522</td>
<td align="right">127598</td>
<td align="left">NDIS only</td>
</tr>
<tr class="even">
<td align="left">New York</td>
<td align="right">0.499</td>
<td align="right">0.347</td>
<td align="right">359666</td>
<td align="right">250109</td>
<td align="left">NDIS only</td>
</tr>
<tr class="odd">
<td align="left">North Carolina</td>
<td align="right">0.411</td>
<td align="right">0.567</td>
<td align="right">143850</td>
<td align="right">198450</td>
<td align="left">SDIS+NDIS</td>
</tr>
<tr class="even">
<td align="left">North Dakota</td>
<td align="right">0.026</td>
<td align="right">0.747</td>
<td align="right">1323</td>
<td align="right">38007</td>
<td align="left">NDIS only</td>
</tr>
<tr class="odd">
<td align="left">Ohio</td>
<td align="right">0.291</td>
<td align="right">0.700</td>
<td align="right">261652</td>
<td align="right">629404</td>
<td align="left">NDIS only</td>
</tr>
<tr class="even">
<td align="left">Oklahoma</td>
<td align="right">0.220</td>
<td align="right">0.692</td>
<td align="right">45274</td>
<td align="right">142407</td>
<td align="left">NDIS only</td>
</tr>
<tr class="odd">
<td align="left">Oregon</td>
<td align="right">0.029</td>
<td align="right">0.867</td>
<td align="right">6797</td>
<td align="right">203201</td>
<td align="left">NDIS only</td>
</tr>
<tr class="even">
<td align="left">Pennsylvania</td>
<td align="right">0.374</td>
<td align="right">0.597</td>
<td align="right">177410</td>
<td align="right">283192</td>
<td align="left">NDIS only</td>
</tr>
<tr class="odd">
<td align="left">Rhode Island</td>
<td align="right">0.380</td>
<td align="right">0.358</td>
<td align="right">10571</td>
<td align="right">9959</td>
<td align="left">SDIS+NDIS</td>
</tr>
<tr class="even">
<td align="left">South Carolina</td>
<td align="right">0.457</td>
<td align="right">0.533</td>
<td align="right">80262</td>
<td align="right">93610</td>
<td align="left">SDIS+NDIS</td>
</tr>
<tr class="odd">
<td align="left">South Dakota</td>
<td align="right">0.060</td>
<td align="right">0.667</td>
<td align="right">3372</td>
<td align="right">37485</td>
<td align="left">Murphy and Tong</td>
</tr>
<tr class="even">
<td align="left">Tennessee</td>
<td align="right">0.255</td>
<td align="right">0.739</td>
<td align="right">132247</td>
<td align="right">383256</td>
<td align="left">SDIS+NDIS</td>
</tr>
<tr class="odd">
<td align="left">Texas</td>
<td align="right">0.291</td>
<td align="right">0.373</td>
<td align="right">353163</td>
<td align="right">452680</td>
<td align="left">Murphy and Tong</td>
</tr>
<tr class="even">
<td align="left">Utah</td>
<td align="right">0.017</td>
<td align="right">0.789</td>
<td align="right">2515</td>
<td align="right">116722</td>
<td align="left">NDIS only</td>
</tr>
<tr class="odd">
<td align="left">Vermont</td>
<td align="right">0.059</td>
<td align="right">0.927</td>
<td align="right">1324</td>
<td align="right">20798</td>
<td align="left">NDIS only</td>
</tr>
<tr class="even">
<td align="left">Virginia</td>
<td align="right">0.439</td>
<td align="right">0.550</td>
<td align="right">223455</td>
<td align="right">279955</td>
<td align="left">SDIS+NDIS</td>
</tr>
<tr class="odd">
<td align="left">Washington</td>
<td align="right">0.116</td>
<td align="right">0.850</td>
<td align="right">31552</td>
<td align="right">231200</td>
<td align="left">SDIS+NDIS</td>
</tr>
<tr class="even">
<td align="left">West Virginia</td>
<td align="right">0.068</td>
<td align="right">0.929</td>
<td align="right">3226</td>
<td align="right">44075</td>
<td align="left">SDIS+NDIS</td>
</tr>
<tr class="odd">
<td align="left">Wisconsin</td>
<td align="right">0.279</td>
<td align="right">0.710</td>
<td align="right">109131</td>
<td align="right">277717</td>
<td align="left">NDIS only</td>
</tr>
<tr class="even">
<td align="left">Wyoming</td>
<td align="right">0.009</td>
<td align="right">0.882</td>
<td align="right">293</td>
<td align="right">28711</td>
<td align="left">NDIS only</td>
</tr>
</tbody>
</table>
<pre class="r"><code>write.csv(final.df, file = &quot;./output/SDIS_racial_composition.csv&quot;, row.names = FALSE)</code></pre>
<p>we generate side-by-side pie charts showing the comparison between
the racial composition of the census (left) and the estimated racial
composition of SDIS (right) for each state.</p>
<p><img src="figure/codis_regression.Rmd/pie-charts-final-1.png" width="1920" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-pie-charts-final-1">
Past versions of pie-charts-final-1.png
</button>
</p>
<div id="fig-pie-charts-final-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/bf233c1982ebfac630984d3d9d72bea774378e51/docs/figure/codis_regression.Rmd/pie-charts-final-1.png" target="_blank">bf233c1</a>
</td>
<td>
Junhui He
</td>
<td>
2025-06-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/3dfd5e12189eadef6caf4176b3e0551ada7c22e4/docs/figure/codis_regression.Rmd/pie-charts-final-1.png" target="_blank">3dfd5e1</a>
</td>
<td>
Junhui He
</td>
<td>
2025-06-17
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="sumary-of-the-sdis-racial-composition" class="section level2">
<h2>Sumary of the SDIS racial composition</h2>
<p>Specifically, we report all states where Black individuals make up
&gt; 50% of the SDIS database.</p>
<pre class="r"><code>black_majority = pis_mt[which(pis_mt$SDIS.black &gt; 0.5), c(&quot;State&quot;, &quot;SDIS.black&quot;, &quot;SDIS.white&quot;, &quot;SDIS.other&quot;)]
colnames(black_majority) = c(&quot;State&quot;, &quot;SDIS.percent.black&quot;, &quot;SDIS.percent.white&quot;, &quot;SDIS.percent.other&quot;)
kable(black_majority, caption = &quot;States where Black individuals make up &gt; 50% of the SDIS database&quot;)</code></pre>
<table style="width:100%;">
<caption>States where Black individuals make up &gt; 50% of the SDIS
database</caption>
<colgroup>
<col width="4%" />
<col width="15%" />
<col width="26%" />
<col width="26%" />
<col width="26%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">State</th>
<th align="right">SDIS.percent.black</th>
<th align="right">SDIS.percent.white</th>
<th align="right">SDIS.percent.other</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">13</td>
<td align="left">Illinois</td>
<td align="right">0.509</td>
<td align="right">0.451</td>
<td align="right">0.040</td>
</tr>
<tr class="even">
<td align="left">18</td>
<td align="left">Louisiana</td>
<td align="right">0.518</td>
<td align="right">0.472</td>
<td align="right">0.011</td>
</tr>
<tr class="odd">
<td align="left">20</td>
<td align="left">Maryland</td>
<td align="right">0.648</td>
<td align="right">0.333</td>
<td align="right">0.019</td>
</tr>
<tr class="even">
<td align="left">30</td>
<td align="left">New Jersey</td>
<td align="right">0.618</td>
<td align="right">0.335</td>
<td align="right">0.047</td>
</tr>
</tbody>
</table>
<p>The maximum and minimum SDIS database sizes are shown below:</p>
<pre class="r"><code>max_min_SDIS = NDIS_SDIS[c(which.max(NDIS_SDIS$N_total.CODIS), 
                            which.min(NDIS_SDIS$N_total.CODIS)),
                         c(&quot;State&quot;,&quot;N_total.SDIS&quot;,&quot;N_total.NDIS&quot;,&quot;N_total.CODIS&quot;)]
kable(max_min_SDIS, caption = &quot;Maximum and minimum SDIS database sizes by state&quot;)</code></pre>
<table>
<caption>Maximum and minimum SDIS database sizes by state</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">State</th>
<th align="right">N_total.SDIS</th>
<th align="right">N_total.NDIS</th>
<th align="right">N_total.CODIS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">5</td>
<td align="left">California</td>
<td align="right">3365402</td>
<td align="right">3269323</td>
<td align="right">3365402</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">Arkansas</td>
<td align="right">12221</td>
<td align="right">261289</td>
<td align="right">12221</td>
</tr>
</tbody>
</table>
<p>Furthermore, we calculate the weighted averages of the racial
proportions in Census and SDIS across seven states provided in Murphy
and Tong [1] and all states, weighted by the corresponding total number
of people in each state. The following table shows the weighted racial
proportions in Census and SDIS across states.</p>
<p><img src="figure/codis_regression.Rmd/plot-weighted-averages-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-plot-weighted-averages-1">
Past versions of plot-weighted-averages-1.png
</button>
</p>
<div id="fig-plot-weighted-averages-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/bf233c1982ebfac630984d3d9d72bea774378e51/docs/figure/codis_regression.Rmd/plot-weighted-averages-1.png" target="_blank">bf233c1</a>
</td>
<td>
Junhui He
</td>
<td>
2025-06-21
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We additionally generate plots showing the difference in the racial
proportions between SDIS and Census in each state.</p>
<p><img src="figure/codis_regression.Rmd/maps-1.png" width="1920" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-maps-1">
Past versions of maps-1.png
</button>
</p>
<div id="fig-maps-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/bf233c1982ebfac630984d3d9d72bea774378e51/docs/figure/codis_regression.Rmd/maps-1.png" target="_blank">bf233c1</a>
</td>
<td>
Junhui He
</td>
<td>
2025-06-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/3dfd5e12189eadef6caf4176b3e0551ada7c22e4/docs/figure/codis_regression.Rmd/maps-1.png" target="_blank">3dfd5e1</a>
</td>
<td>
Junhui He
</td>
<td>
2025-06-17
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><img src="figure/codis_regression.Rmd/maps-2.png" width="1920" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-maps-2">
Past versions of maps-2.png
</button>
</p>
<div id="fig-maps-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/bf233c1982ebfac630984d3d9d72bea774378e51/docs/figure/codis_regression.Rmd/maps-2.png" target="_blank">bf233c1</a>
</td>
<td>
Junhui He
</td>
<td>
2025-06-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lasisilab/PODFRIDGE/blob/3dfd5e12189eadef6caf4176b3e0551ada7c22e4/docs/figure/codis_regression.Rmd/maps-2.png" target="_blank">3dfd5e1</a>
</td>
<td>
Junhui He
</td>
<td>
2025-06-17
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We conclude that Black/African Americans are overrepresented and
white Americans are underrepresented in the forensic database compared
to Census.</p>
</div>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<p>[1] Murphy, Erin, and Jun H. Tong. “The racial composition of
forensic DNA databases.” Calif. L. Rev. 108 (2020): 1847.</p>
<p>[2] Klein, Brennan, et al. “COVID-19 amplified racial disparities in
the US criminal legal system.” Nature 617.7960 (2023): 344-350.</p>
<p>[3] <a
href="https://le.fbi.gov/science-and-lab/biometrics-and-fingerprints/codis/codis-ndis-statistics"
class="uri">https://le.fbi.gov/science-and-lab/biometrics-and-fingerprints/codis/codis-ndis-statistics</a></p>
<p>[4] U.S. Census Bureau. “Population.” <a
href="https://www.census.gov/topics/population.html"
class="uri">https://www.census.gov/topics/population.html</a><br />
</p>
<p>[5] <a
href="https://www.vera.org/downloads/pdfdownloads/state-incarceration-trends-michigan.pdf"
class="uri">https://www.vera.org/downloads/pdfdownloads/state-incarceration-trends-michigan.pdf</a><br />
</p>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>
Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.1 (2023-06-16)
Platform: aarch64-apple-darwin20 (64-bit)
Running under: macOS 15.5

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/Detroit
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] sf_1.0-21         viridis_0.6.5     viridisLite_0.4.2 cowplot_1.1.3    
 [5] tidycensus_1.7.1  sandwich_3.1-1    ggpubr_0.6.0      jtools_2.3.0     
 [9] knitr_1.50        lubridate_1.9.4   forcats_1.0.0     stringr_1.5.1    
[13] dplyr_1.1.4       purrr_1.0.4       tidyr_1.3.1       tibble_3.2.1     
[17] ggplot2_3.5.2     tidyverse_2.0.0   readr_2.1.5       workflowr_1.7.1  

loaded via a namespace (and not attached):
 [1] tidyselect_1.2.1    farver_2.1.2        fastmap_1.2.0      
 [4] promises_1.3.3      digest_0.6.37       timechange_0.3.0   
 [7] lifecycle_1.0.4     processx_3.8.6      magrittr_2.0.3     
[10] compiler_4.3.1      rlang_1.1.6         sass_0.4.10        
[13] tools_4.3.1         yaml_2.3.10         ggsignif_0.6.4     
[16] labeling_0.4.3      curl_6.2.3          classInt_0.4-11    
[19] xml2_1.3.8          RColorBrewer_1.1-3  KernSmooth_2.23-21 
[22] abind_1.4-8         withr_3.0.2         grid_4.3.1         
[25] git2r_0.36.2        e1071_1.7-16        future_1.40.0      
[28] globals_0.17.0      scales_1.4.0        cli_3.6.5          
[31] crayon_1.5.3        rmarkdown_2.29      generics_0.1.4     
[34] rstudioapi_0.17.1   httr_1.4.7          tzdb_0.5.0         
[37] DBI_1.2.3           cachem_1.1.0        proxy_0.4-27       
[40] pander_0.6.6        splines_4.3.1       rvest_1.0.4        
[43] parallel_4.3.1      tigris_2.2.1        vctrs_0.6.5        
[46] jsonlite_2.0.0      carData_3.0-5       car_3.1-3          
[49] callr_3.7.6         hms_1.1.3           rstatix_0.7.2      
[52] Formula_1.2-5       listenv_0.9.1       jquerylib_0.1.4    
[55] units_0.8-7         glue_1.8.0          parallelly_1.45.0  
[58] codetools_0.2-19    ps_1.9.1            stringi_1.8.7      
[61] gtable_0.3.6        later_1.4.2         broom.mixed_0.2.9.6
[64] furrr_0.3.1         pillar_1.10.2       rappdirs_0.3.3     
[67] htmltools_0.5.8.1   R6_2.6.1            rprojroot_2.0.4    
[70] evaluate_1.0.3      lattice_0.21-8      backports_1.5.0    
[73] broom_1.0.8         httpuv_1.6.16       bslib_0.9.0        
[76] class_7.3-22        uuid_1.2-1          Rcpp_1.0.14        
[79] gridExtra_2.3       nlme_3.1-162        whisker_0.4.1      
[82] xfun_0.52           fs_1.6.6            zoo_1.8-14         
[85] getPass_0.2-4       pkgconfig_2.0.3    </code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
https://docs.mathjax.org/en/latest/web/configuration.html. This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
